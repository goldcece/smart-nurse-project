import time
import streamlit as st
import os
import pandas as pd
from langchain.chat_models import AzureChatOpenAI
from langchain.callbacks.base import BaseCallbackHandler
from langchain.prompts import ChatPromptTemplate, FewShotChatMessagePromptTemplate
from langchain.schema import HumanMessage, AIMessage

st.set_page_config(
    page_title="SmartNurse ChatBot",
    page_icon="π‘©β€β•οΈ",
)

class ChatCallbackHandler(BaseCallbackHandler):
    message = ""

    def on_llm_start(self, *args, **kwargs):
        with st.chat_message('ai'):
            self.message_box = st.empty()

    def on_llm_end(self, *args, **kwargs):
        save_message(self.message, "ai")

    def on_llm_new_token(self, token, *args, **kwargs):
        self.message += token
        self.message_box.markdown(self.message)


azure = AzureChatOpenAI(
    api_key='key',
    api_version='version',
    azure_endpoint="endpoint",
    deployment_name='model',
    model_name='model_name',
    temperature=0.1,
    streaming=True,
    callbacks=[
        ChatCallbackHandler(),],
)

def save_message(message, role):
    st.session_state["messages"].append({"message": message, "role": role})


def send_message(message, role, save=True):
    with st.chat_message(role):
        st.markdown(message)
    if save:
        save_message(message, role)
        
def paint_history():
    for message in st.session_state["messages"]:
        send_message(
            message["message"],
            message["role"],
            save=False,
        )

# κΈ°λ³Έ ν”„λ΅¬ν”„νΈ ν…ν”λ¦Ώ μƒμ„±
example_prompt = ChatPromptTemplate.from_messages(
    [
        ("human", "{input}"),
        ("ai", "{output}"),
    ]
)

# ν•΄κ²°ν•  μ‚¬ν•­: μ¤„λ°”κΏ, μ–‘μ‹ λ„£μ–΄μ•Ό ν•λ”μ§€, 

# NANDA
examples_NANDA = [
    {"input": "λΉ„ν¨κ³Όμ  νΈν΅ μ–‘μƒ ν™μμ κ°„νΈκΈ°λ΅ NANDA μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄\n\nμ΄λ¦„: μ΄ν•΄μ¤€\nλ‚μ΄: 34μ„Έ\nμ„±λ³„: λ‚¨μ„±\n\nμ§„λ‹¨: λΉ„ν¨κ³Όμ  νΈν΅ μ–‘μƒ (NANDA-I #00032)\n\nμλ£ μμ§‘ μ£Όκ΄€μ  / κ°κ΄€μ :\n\n-νΈν΅μ μ¦κ°€ (λ¶„λ‹Ή 24ν)\n-νΈν΅κ³¤λ€ μ¦μƒ (μ–•κ³  λΉ λ¥Έ νΈν΅)\n-μ‚°μ†ν¬ν™”λ„ κ°μ† (92%)\n-ν™μμ μ£Όκ΄€μ  νΈν΅ λ¶νΈ ν‘ν„\n\nλ‹¨κΈ° λ©ν‘:\n\n-ν™μμ νΈν΅μκ°€ 24μ‹κ°„ μ΄λ‚΄μ— λ¶„λ‹Ή 12~20νλ΅ μ •μƒ λ²”μ„ λ‚΄λ΅ κ°μ†\n-μ‚°μ†ν¬ν™”λ„κ°€ 95% μ΄μƒμΌλ΅ μ μ§€\n\nμ¥κΈ° λ©ν‘:\n\n-ν™μκ°€ νΈν΅ κ³¤λ€μ„ νΈμ†ν•μ§€ μ•κ³ , μ‚°μ†ν¬ν™”λ„κ°€ μ§€μ†μ μΌλ΅ 95% μ΄μƒ μ μ§€\n-ν™μκ°€ νΈν΅μ— κ΄€λ ¨λ μκ°€ κ΄€λ¦¬ λ°©λ²•μ„ μ΄ν•΄ν•κ³  μ‹¤ν–‰\n\nκ°„νΈμν–‰/μ¤‘μ¬/μ΄λ΅ μ  κ·Όκ±° Interventions:\n\n-νΈν΅ μƒνƒ λ¨λ‹ν„°λ§: 2μ‹κ°„λ§λ‹¤ νΈν΅μ, μ‚°μ†ν¬ν™”λ„ μ²΄ν¬\n-μ‚°μ† μ”λ²•: μμ‚¬μ μ§€μ‹μ— λ”°λΌ μ‚°μ† κ³µκΈ‰ (ν•„μ” μ‹)\n-νΈν΅ μ΄λ™ κµμ΅: κΉκ³  μ²μ²ν μ¨μ‰¬κΈ°, λ³µμ‹νΈν΅λ²• κµμ΅\n-μ•μ„ μ κ³µ: νΈμ•ν• μμ„Έ μ μ§€, μ¤νΈλ μ¤ κ°μ† λ°©λ²• μ•λ‚΄\n-κµμ΅ λ° μƒλ‹΄: νΈν΅κ³¤λ€μ μ›μΈκ³Ό κ΄€λ¦¬ λ°©λ²• μ„¤λ…\n\nκ°„νΈν‰κ°€ Evaluation\n-νΈν΅ μƒνƒ: νΈν΅μ λ° μ‚°μ†ν¬ν™”λ„ λ³€ν™” λ¨λ‹ν„°λ§\n-ν™μμ μκ°€ κ΄€λ¦¬ λ¥λ ¥: νΈν΅ μ΄λ™ μ‹¤μ‹ μ—¬λ¶€ λ° ν¨κ³Ό ν‰κ°€\n-κµμ΅ ν¨κ³Ό: ν™μμ μ΄ν•΄λ„ λ° λ°μ‘ κ΄€μ°°"},
    {"input": "λΉ„ν¨κ³Όμ  κΈ°λ„ μ²­κ²° ν™μμ κ°„νΈκΈ°λ΅ NANDA μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄\n μ΄λ¦„: μ΄μƒμ§„\n λ‚μ΄: 45μ„Έ\n μ„±λ³„: λ‚¨μ„±\n\nμ§„λ‹¨: λΉ„ν¨κ³Όμ  κΈ°λ„ μ²­κ²° (NANDA-I #00031)\n\nμλ£ μμ§‘ μ£Όκ΄€μ  / κ°κ΄€μ :\n\n-κ°€λ μ¦κ°€ λ° μ λ„ λ†’μ\n-κΈ°μΉ¨ ν¨κ³Ό κ°μ†\n-νΈν΅ μ‹ μ²λ…μ\n-ν™μ νΈν΅ λ¶νΈ νΈμ†\n\nλ‹¨κΈ° λ©ν‘:\n\n-24μ‹κ°„ λ‚΄ κ°€λ μ κ±° μ©μ΄\n-νΈν΅ μ‹ μ²­κ²°ν• κΈ°λ„ μ μ§€\n\nμ¥κΈ° λ©ν‘:\n\n-κΈ°λ„ μ²­κ²° μƒνƒ μ μ§€\n-νΈν΅ κ³¤λ€ λλ” κ°€λ λ¬Έμ  λ¶ν‰ μ—†μ\n-μκ°€ κ΄€λ¦¬ λ¥λ ¥ ν–¥μƒ\n\nκ°„νΈμν–‰/μ¤‘μ¬/μ΄λ΅ μ  κ·Όκ±° Interventions:\n\n-νΈν΅ μƒνƒ λ° κ°€λ μƒνƒ λ¨λ‹ν„°λ§: λ§¤ 4μ‹κ°„λ§λ‹¤ ν μ²­μ§„ λ° κ°€λ μ–‘, μ„±μ§ ν™•μΈ\n-κ°€μµ μ”λ²•: μ μ ν• μλ¶„ μ„­μ·¨ λ° ν™κ²½ κ°€μµ μ μ§€\n-κΈ°λ„ μ²­μ† μ§€μ›: μ²΄μ„ λ°°μ•΅, κ°€μ΄ νƒ€μ§„, ν¨κ³Όμ  κΈ°μΉ¨ κΈ°μ  κµμ΅ λ° μ‹¤μµ\n-ν΅μΈ μ¤€λΉ„: ν•„μ” μ‹ μ¦‰κ°μ μΈ ν΅μΈ κ°€λ¥ν•λ„λ΅ κΈ°κµ¬ μ¤€λΉ„\n-ν™μ λ° λ³΄νΈμ κµμ΅: κΈ°λ„ μ²­κ²° μ μ§€ λ°©λ²•, μ¤‘μ”μ„± μ„¤λ…\n\nκ°„νΈν‰κ°€ Evaluation\n\n-νΈν΅ μƒνƒ λ³€ν™”: νΈν΅μ, μ²­μ§„ μ†κ²¬, κ°€λ μ–‘ λ° μ„±μ§ μ¶”μ \n-μκ°€ κ΄€λ¦¬ λ¥λ ¥: κΈ°λ„ μ²­κ²° μ μ§€ κΈ°μ  μ‹¤μ² μ—¬λ¶€ λ° ν¨κ³Ό ν‰κ°€\n-κµμ΅ μ΄ν•΄λ„: ν™μ λ° λ³΄νΈμμ λ°μ‘ λ° ν”Όλ“λ°± ν™•μΈ"},
    {"input": "κ°€μ¤ κµν™ μ¥μ•  ν™μμ κ°„νΈκΈ°λ΅ NANDA μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄\n μ΄λ¦„: μ •νΈμ„\n λ‚μ΄: 32μ„Έ\n μ„±λ³„: λ‚¨μ„±\n\nμ§„λ‹¨: κ°€μ¤ κµν™ μ¥μ•  (NANDA-I #00030)\n\nμλ£ μμ§‘ μ£Όκ΄€μ  / κ°κ΄€μ :\n\n-λ™λ§¥ν κ°€μ¤ λ¶„μ„ μƒ μ‚°μ† ν¬ν™”λ„ 88%, μ΄μ‚°ν™”νƒ„μ† λ†λ„ μƒμΉ\n-νΈν΅κ³¤λ€, μ–•κ³  λΉ λ¥Έ νΈν΅ (λ¶„λ‹Ή 30ν)\n-μ‹μ•μ¦, μ°½λ°±ν•¨ κ΄€μ°°\n-ν™μ νΈν΅ λ¶νΈ νΈμ†\n\nλ‹¨κΈ° λ©ν‘:\n\n-24μ‹κ°„ λ‚΄ μ‚°μ†ν¬ν™”λ„ 94-98% λ²”μ„ λ‚΄ μ μ§€\n-νΈν΅κ³¤λ€ μ¦μƒ κ°μ†\n\nμ¥κΈ° λ©ν‘:\n\n-νΈν΅ κ³¤λ€ μ—†μ΄ μ•μ •λ κ°€μ¤ κµν™ μƒνƒ μ μ§€\n-νΈν΅ κ΄€λ¦¬ μκ°€ μν–‰ λ¥λ ¥ ν–¥μƒ\n\nκ°„νΈμν–‰/μ¤‘μ¬/μ΄λ΅ μ  κ·Όκ±° Interventions:\n\n-νΈν΅ μƒνƒ λ° μ‚°μ†ν¬ν™”λ„ λ¨λ‹ν„°λ§: μ •κΈ°μ μΌλ΅ νΈν΅μ, μ‚°μ†ν¬ν™”λ„ μ²΄ν¬\n-μ‚°μ† μ”λ²•: μμ‚¬ μ§€μ‹μ— λ”°λΌ μ‚°μ† κ³µκΈ‰ μ΅°μ •\n-νΈν΅ μ΄λ™ λ° μ²΄μ„ κµμ΅: κΉκ³  μ²μ²ν μ¨μ‰¬κΈ°, λ³µμ‹νΈν΅λ²• κµμ΅ λ° μ‹¤μµ\n-μ¤νΈλ μ¤ κ΄€λ¦¬: μ•μ • λ° ν΄μ‹ μ΄‰μ§„, ν™μ λ¶μ• κ°μ† κΈ°λ²• μ•λ‚΄\n-ν™μ λ° λ³΄νΈμ κµμ΅: κ°€μ¤ κµν™ μ¥μ•  μ›μΈ, μ¤‘μ”μ„± λ° μκ°€ κ΄€λ¦¬ λ°©λ²• μ„¤λ…\n\nκ°„νΈν‰κ°€ Evaluation\n\n-νΈν΅ μƒνƒ λ³€ν™”: νΈν΅μ, μ‚°μ†ν¬ν™”λ„ μ¶”μ \n-μκ°€ κ΄€λ¦¬ λ¥λ ¥: νΈν΅ μ΄λ™ μν–‰ μ—¬λ¶€ λ° ν¨κ³Ό ν‰κ°€\n-κµμ΅ μ΄ν•΄λ„: ν™μ λ° λ³΄νΈμ λ°μ‘ λ° ν”Όλ“λ°± ν™•μΈ"},
    {"input": "λ‚™μƒ μ„ν— ν™μμ κ°„νΈκΈ°λ΅ NANDA μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄\n μ΄λ¦„: μ΄μ¤μ•„\n λ‚μ΄: 67μ„Έ\n μ„±λ³„: μ—¬μ„±\n\nμ§„λ‹¨: λ‚™μƒ μ„ν— (NANDA-I #00155)\n\nμλ£ μμ§‘ μ£Όκ΄€μ  / κ°κ΄€μ :\n\n-λ³΄ν–‰ λ¶μ•μ •\n-κ· ν• μ¥μ• \n-μ•½λ¬Ό λ¶€μ‘μ© μν–¥ (μ: μ§„μ •μ  μ‚¬μ©)\n-μ‹κ° μ¥μ• \n-ν™κ²½μ  μ„ν— μ”μ† (μ: λ―Έλ„λ¬μ΄ λ°”λ‹¥)\n\nλ‹¨κΈ° λ©ν‘:\n\n-24μ‹κ°„ λ‚΄ ν™μ μ•μ „ν• μ΄λ™ λ° ν™λ™ μ μ§€\n-ν™μ λ° λ³΄νΈμ λ‚™μƒ μλ°© μ΅°μΉ μ΄ν•΄ λ° μ¤€μ\n\nμ¥κΈ° λ©ν‘:\n\n-μ…μ› κΈ°κ°„ λ‚™μƒ μ—†μ΄ μ•μ „ μ μ§€\n-μκ°€ κ΄€λ¦¬λ¥Ό ν†µν• λ‚™μƒ μ„ν— μµμ†ν™”\n\nκ°„νΈμν–‰/μ¤‘μ¬/μ΄λ΅ μ  κ·Όκ±° Interventions:\n\n-λ‚™μƒ μ„ν— ν‰κ°€: μ •κΈ°μ  λ‚™μƒ μ„ν— ν‰κ°€ μν–‰\n-ν™κ²½ μ΅°μ •: λ‚™μƒ μ„ν— κ°μ† ν™κ²½ μ΅°μ„± (μ: λ―Έλ„λΌ λ°©μ§€ λ§¤νΈ, μ μ ν• μ΅°λ… μ„¤μΉ)\n-λ³΄ν–‰ λ³΄μ΅°κΈ°κµ¬ μ‚¬μ©: ν•„μ” μ‹ λ³΄ν–‰ λ³΄μ΅°κΈ°κµ¬ μ κ³µ λ° μ‚¬μ©λ²• κµμ΅\n-μ•½λ¬Ό κ΄€λ¦¬: λ‚™μƒ μ„ν— μ¦κ°€ μ•½λ¬Ό λ¨λ‹ν„°λ§ λ° μ΅°μ •\n-κµμ΅ λ° μƒλ‹΄: λ‚™μƒ μλ°© λ°©λ²• λ° ν™κ²½ μ•μ „ μ μ§€ κµμ΅\n\nκ°„νΈν‰κ°€ Evaluation\n\n-μ΄λ™ λ¥λ ¥: λ³΄ν–‰ μ•μ •μ„± λ° κ· ν• μ μ§€ λ¥λ ¥ ν‰κ°€\n-ν™κ²½ μ•μ „μ„±: ν™κ²½ μ•μ „ μ§€μ†μ  ν™•μΈ\n-κµμ΅ ν¨κ³Ό: λ‚™μƒ μλ°© μ΅°μΉ μ΄ν•΄λ„ λ° μ‹¤ν–‰ μ—¬λ¶€ ν‰κ°€"}
]
few_shot_prompt_NANDA = FewShotChatMessagePromptTemplate(
    example_prompt=example_prompt,
    examples=examples_NANDA 
)
instruction_NANDA = """
You are a 5th nurse working in a general hospital. Answer the question, adhering to the following guidelines:
1. Write in Korean
2. Utilize the information available in the prompt. If relevant information is not found there, then seek answers through other channels.
3. Use precise and concise language. Use endings like μ, ν•¨, μ„.
4. Necessary to write a nursing record following this format.
###
ν™μ μ •λ³΄
- μ΄λ¦„:
- λ‚μ΄:
- μ„±λ³„:

μλ£ μμ§‘ μ£Όκ΄€μ  / κ°κ΄€μ 
- Substructure

κ°„νΈλ©ν‘ λ‹¨κΈ°/μ¥κΈ° Goal
- Substructure

κ°„νΈκ³„ν Plan
- Substructure

κ°„νΈμν–‰/μ¤‘μ¬/μ΄λ΅ μ  κ·Όκ±° Interventions
- Substructure

κ°„νΈν‰κ°€ Evaluation
- Substructure
###
5. Combine 'μ£Όμ” μ¦μƒ λ° νΉμ„±', 'μλ£ μμ§‘ μ£Όκ΄€μ ', 'μλ£ μμ§‘ κ°κ΄€μ ' in NANDA format to 'μλ£ μμ§‘ μ£Όκ΄€μ  / κ°κ΄€μ '.
6. Combine 'λ‹¨κΈ°λ©ν‘' and 'μ¥κΈ°λ©ν‘' in NANDA format to 'κ°„νΈλ©ν‘ λ‹¨κΈ°/μ¥κΈ° Goal'.
7. Instead of using numeric order, Use bullet points for the description.
8. Please write as specifically as possible. For example, instead of a generic response like 'μ μ ν• νΈν΅ κΈ°λ²• κµμ΅', provide a more detailed answer such as 'νΈν΅ μ΄λ™ κµμ΅: κΉκ³  μ²μ²ν μ¨μ‰¬κΈ°, λ³µμ‹νΈν΅λ²• κµμ΅'.
9. Record precise numerical data. For example, provide specific details like 'ν™μμ νΈν΅μκ°€ 24μ‹κ°„ μ΄λ‚΄μ— λ¶„λ‹Ή 12~20νλ΅ μ •μƒ λ²”μ„ λ‚΄λ΅ κ°μ†'.
"""

final_prompt_NANDA = ChatPromptTemplate.from_messages(
    [
        ("system", instruction_NANDA),
        few_shot_prompt_NANDA,
        ("human", "{input}"),
    ]
)

# SOAPIE
examples_SOAPIE = [
    {"input": "λ¶μ•μ •ν• νμ••μ μ„ν— ν™μμ κ°„νΈκΈ°λ΅μ„ SOAPIE μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄ \n μ΄λ¦„: κΉ€κ²½μ£Ό\n λ‚μ΄: 61μ„Έ\n μ„±λ³„: λ‚¨μ„±\n\n\μ£Όκ΄€μ  μ¦μƒ Subjective Data\n ν™μλ” μµκ·Όμ— λ‘ν†µκ³Ό μ–΄μ§€λ¬μ›€μ„ μμ£Ό λλΌλ©° \"λ μ•μ΄ νλ¦Ών•κ³  κ°€λ”μ”© λ‘κ·Όκ±°λ¦¬λ” λλ‚μ΄ λ“¤μ–΄\"λΌκ³  μ–ΈκΈ‰ν•¨.\n\nκ°κ΄€μ  μ •λ³΄ Objective Data \nνμ•• μΈ΅μ • κ²°κ³Ό : μμ¶•κΈ° νμ••μ΄ 150 mmHgλ¥Ό λ„μ–΄μ„κ³  μ΄μ™„κΈ° νμ••λ„ 95 mmHgλ¥Ό λ„μ–΄μ„¬. \nμ‹¬λ°•μλ” μ •μƒ λ²”μ„ λ‚΄μ— μμ.\n\nμ‚¬μ • Assessment \nν™μλ” λ¶μ•μ •ν• νμ•• μƒνƒμ— μμΌλ©°  κ³ νμ••μ— λ”°λ¥Έ λ‘ν†µ λ° μ–΄μ§€λ¬μ›€μ΄ λ‚νƒ€λ‚¨.\n\nκ³„ν Planning  \n-νμ•• κ°μ‹ λ° κΈ°λ΅   \n-μƒν™μ–‘μ‹ κ°μ„  λ° μ €μ—Ό μ‹μ΄ κ¶κ³    \n-μ‹¬λ¦¬μ  μ§€μ› λ° μ¤νΈλ μ¤ κ΄€λ¦¬ κµμ΅.\n\nμ¤‘μ¬ Interventions \n-νμ••μ„ μ •κΈ°μ μΌλ΅ κ°μ‹ν•κ³  κΈ°λ΅ν•¨   \n-μμ–‘μ‚¬μ™€ ν‘λ ¥ν•μ—¬ μƒν™μ–‘μ‹ κ°μ„ κ³Ό μ €μ—Ό μ‹μ΄λ¥Ό κ¶κ³ ν•¨   \n-μ‹¬λ¦¬μƒλ‹΄μ‚¬μ™€ ν‘λ ¥ν•μ—¬ μ¤νΈλ μ¤ κ΄€λ¦¬ κµμ΅μ„ μ κ³µν•¨.\n\nν‰κ°€ Evaluation \n-νμ•• κ°μ‹λ΅ νμ••μ΄ μ•μ •λκ³  μμμ„ ν™•μΈν•¨   \n-μμ–‘ μƒνƒκ°€ κ°μ„ λκ³  νμ•• κ΄€λ¦¬μ— λ„μ›€μ΄ λλ” μ‹μ΄ μµκ΄€μ΄ ν•μ„±λ¨   \n-μ¤νΈλ μ¤ κ΄€λ¦¬ κµμ΅μ„ ν†µν•΄ ν™μμ μ •μ„μ  μƒνƒκ°€ κ°μ„ λ¨."},
    {"input": "κ·Όμ΅μ κΈ΄μ¥ ν™μμ κ°„νΈκΈ°λ΅μ„ SOAPIE μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄ \n μ΄λ¦„: λ°•μ„±νΈ\n λ‚μ΄: 40μ„Έ\n μ„±λ³„: λ‚¨μ„±\n\nμ£Όκ΄€μ  μ¦μƒ Subjective Data\n ν™μλ” \"μ–΄κΉ¨μ™€ λ©μ΄ λ­‰μ³μ„ ν†µμ¦μ΄ μκ³    μμ£Ό λ‘ν†µλ„ λκ»΄μ Έ\"λΌκ³  μ–ΈκΈ‰ν•¨.\n\nκ°κ΄€μ  μ •λ³΄ Objective Data \nμ–΄κΉ¨μ™€ λ© μ£Όλ³€ κ·Όμ΅μ΄ κ²½μ§λμ–΄ μμΌλ©°   ν™μλ” ν—λ¦¬λ¥Ό κµ¬λ¶€λ¦¬κΈ° μ–΄λ ¤μ›ν•λ” λ¨μµμ„ λ³΄μ„. \nνΉν μ–΄κΉ¨ λ¶€λ¶„μ—μ„ λ‘ν†µμ΄ λ°μƒν•λ” κ²ƒμΌλ΅ λ‚νƒ€λ‚¨.\n\nμ‚¬μ • Assessment \nν™μλ” κ·Όμ΅μ κΈ΄μ¥μΌλ΅ μΈν• μ–΄κΉ¨μ™€ λ© ν†µμ¦   κ·Έλ¦¬κ³  λ‘ν†µμ„ κ²½ν—ν•κ³  μμ.\n\nκ³„ν Planning  \n-κ·Όμ΅ μ΄μ™„μ„ μ„ν• μ•μ •μ μΈ μμ„Έ κµμ΅   \n-λ”°λ»ν• μ°μ§ μ μ©   \n-μμ‚¬μ μ²λ°©μ— λ”°λ¥Έ κ·Όμ΅ μ΄μ™„μ„ λ•λ” μ•½λ¬Ό ν¬μ—¬.\n\nμ¤‘μ¬ Interventions \n-μ¬λ°”λ¥Έ μμ„Έ μ μ§€λ¥Ό κµμ΅ν•μ—¬ κ·Όμ΅μ— κ°€ν•΄μ§€λ” μ••λ ¥μ„ μµμ†ν™”ν•¨   \n-λ”°λ»ν• μ°μ§μ„ ν†µν•΄ κ·Όμ΅μ„ μ΄μ™„μ‹ν‚¤κ³  νμ•΅ μν™μ„ μ΄‰μ§„ν•¨   \n-μμ‚¬μ μ²λ°©μ— λ”°λΌ κ·Όμ΅ μ΄μ™„μ„ λ•λ” μ•½λ¬Όμ„ ν¬μ—¬ν•¨.\n\nν‰κ°€ Evaluation \n-μ¬λ°”λ¥Έ μμ„Έ μ μ§€λ΅ κ·Όμ΅μ κΈ΄μ¥μ΄ κ°μ†ν•κ³  ν†µμ¦μ΄ μ™„ν™”λ¨   \n-λ”°λ»ν• μ°μ§λ΅ κ·Όμ΅μ΄ μ΄μ™„λμ–΄ μ›€μ§μ„μ΄ μ μ—°ν•΄μ§   \n-μ•½λ¬Ό ν¬μ—¬λ΅ κ·Όμ΅μ κΈ΄μ¥μ΄ μ™„ν™”λκ³  ν†µμ¦μ΄ κ°μ†ν•¨."},
    {"input": "abdomen pain NRS 7μ  ν™μμ κ°„νΈκΈ°λ΅μ„ SOAPIE μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄ \n μ΄λ¦„: λ°•μ§€ν„\n λ‚μ΄: 45μ„Έ\n μ„±λ³„: λ‚¨μ„±\n\nμ£Όκ΄€μ  μ¦μƒ Subjective Data\n ν™μλ” \"λ³µλ¶€κ°€ μ‹¬ν•κ² μ•„ν”„κ³    ν†µμ¦μ΄ 8μ  μ •λ„λ΅ μ‹¬ν•΄\"λΌκ³  μ–ΈκΈ‰ν•¨.\n\nκ°κ΄€μ  μ •λ³΄ Objective Data \nλ³µλ¶€ λ¶€μ„μ—μ„ ν™μμ ν‘μ •μ΄ λ¶νΈν•λ©°   λ³µλ¶€λ¥Ό λ§μ§€λ©΄ ν†µμ¦μΌλ΅ μΈν•΄ ν”Όλ¶€κ°€ κΈ΄μ¥λμ–΄ μμ. \nNRS(Numeric Rating Scale)λ΅ μΈ΅μ •ν• ν†µμ¦ μ μλ” 8/10μ„.\n\nμ‚¬μ • Assessment \nν™μλ” μ‹¬ν• λ³µλ¶€ ν†µμ¦μΌλ΅ κ³ ν†µμ„ κ²κ³  μμ.\n\nκ³„ν Planning  \n-μμ‚¬μ™€μ μƒλ‹΄ ν›„ ν†µμ¦ κ΄€λ¦¬ κ³„ν μλ¦½   \n-ν†µμ¦ κ΄€λ¦¬λ¥Ό μ„ν• μ•½λ¬Ό ν¬μ—¬   \n-ν†µμ¦μ μ›μΈμ„ ν‰κ°€ν•κΈ° μ„ν• μ¶”κ°€ μ§„λ‹¨ κ²€μ‚¬ μ‹¤μ‹.\n\nμ¤‘μ¬ Interventions \n-μμ‚¬μ μ§€μ‹μ— λ”°λΌ ν†µμ¦ κ΄€λ¦¬ κ³„νμ„ μν–‰ν•¨   \n-ν†µμ¦μ„ μ™„ν™”ν•κΈ° μ„ν•΄ μμ‚¬μ μ²λ°©μ— λ”°λΌ μ•½λ¬Όμ„ ν¬μ—¬ν•¨   \n-μ¶”κ°€ μ§„λ‹¨ κ²€μ‚¬λ¥Ό μ„ν•΄ ν•„μ”ν• μ΅°μΉλ¥Ό μ·¨ν•¨.\n\nν‰κ°€ Evaluation \n-ν†µμ¦ κ΄€λ¦¬ κ³„νμ„ ν†µν•΄ ν†µμ¦μ΄ κ°μ†ν•¨   \n-μ•½λ¬Ό ν¬μ—¬λ΅ μΈν•΄ ν™μμ νΈμ•ν•¨μ΄ μ¦κ°€ν•¨   \n-μ¶”κ°€ μ§„λ‹¨ κ²€μ‚¬ κ²°κ³Όλ¥Ό ν† λ€λ΅ ν†µμ¦μ μ›μΈμ„ νμ•…ν•κ³  μ΅°μΉλ¥Ό μ·¨ν•¨."},
    {"input": "μ™Έμƒμ„± μ§€μ£Όλ§‰ν• μ¶ν ν™μμ κ°„νΈκΈ°λ΅μ„ SOAPIE μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄ \n μ΄λ¦„: λ°•μ„±μ¤€\n λ‚μ΄: 22μ„Έ\n μ„±λ³„: λ‚¨μ„±\n\nμ£Όκ΄€μ  μ¦μƒ Subjective Data\n ν™μλ” \"λ¨Έλ¦¬κ°€ μ‹¬ν•κ² μ•„ν”„κ³    μ•κµ¬ μ£Όμ„μ— λλ¬Όμ΄ λ‚μ¤λ©΄μ„ μ‹μ•Όκ°€ νλ¦Ών•΄μ Έ\"λΌκ³  μ–ΈκΈ‰ν•¨.\n\nκ°κ΄€μ  μ •λ³΄ Objective Data \nλ¨Έλ¦¬μ— μ¶ν λ¶€μ„κ°€ λ³΄μ΄λ©°   μ•κµ¬ μ£Όμ„μ— νμΆ…μ΄ ν•μ„±λμ–΄ μμ. \nν™μμ μ‹μ•Όκ°€ νλ¦Ών•κ³  λΉ›μ— λ―Όκ°ν• λ°μ‘μ΄ λ‚νƒ€λ‚¨.\n\nμ‚¬μ • Assessment \nμ™Έμƒμ„± μ§€μ£Όλ§‰ν• μ¶νλ΅ μΈν• λ¨Έλ¦¬ ν†µμ¦ λ° μ‹μ•Ό μ¥μ• λ¥Ό κ²½ν—ν•κ³  μμ.\n\nκ³„ν Planning \n-μμ‚¬μ™€μ ν‘μ ν›„ μ¶ν κ΄€λ¦¬ κ³„ν μλ¦½   \n-μ•κµ¬ μ£Όμ„ νμΆ…μ μ••λ ¥ μ™„ν™”λ¥Ό μ„ν• μ΅°μΉ   \n-μμ‚¬μ μ§€μ‹μ— λ”°λΌ λ¨Έλ¦¬ CT λ“± μ¶”κ°€ κ²€μ‚¬ μ‹¤μ‹.\n\nμ¤‘μ¬ Interventions \n-μ¶ν κ΄€λ¦¬ κ³„νμ„ μν–‰ν•¨   \n-μ•κµ¬ μ£Όμ„ νμΆ…μ„ ν”Όν•κΈ° μ„ν•΄ λ¨Έλ¦¬λ¥Ό κ³ μ •ν•λ” μ΅°μΉλ¥Ό μ‹ν–‰ν•¨   \n-μμ‚¬μ μ§€μ‹μ— λ”°λΌ λ¨Έλ¦¬ CT λ“± μ¶”κ°€ κ²€μ‚¬λ¥Ό μ‹ν–‰ν•¨.\n\nν‰κ°€ Evaluation \n-μ¶ν κ΄€λ¦¬ κ³„νμ„ ν†µν•΄ μ¶ν μ–‘μƒμ΄ κ°μ†ν•¨   \n-μ•κµ¬ μ£Όμ„ νμΆ…μ μ••λ ¥ μ™„ν™”λ΅ μ‹μ•Ό μ¥μ• κ°€ κ°μ„ λ¨   \n-μ¶”κ°€ κ²€μ‚¬ κ²°κ³Όλ¥Ό ν†µν•΄ μ¶νμ μ •ν™•ν• μ„μΉμ™€ μ •λ„λ¥Ό ν™•μΈν•¨."}
]
few_shot_prompt_SOAPIE = FewShotChatMessagePromptTemplate(
    example_prompt=example_prompt,
    examples=examples_SOAPIE
)
instruction_SOAPIE = """
You are a 5th nurse working in a general hospital. Answer the question, adhering to the following guidelines:
1. Write in Korean
2. Utilize the information available in the prompt. If relevant information is not found there, then seek answers through other channels.
3. Use precise and concise language. Use endings like μ, ν•¨, μ„.
4. Necessary to write a nursing record following this format.
###
ν™μ μ •λ³΄
- μ΄λ¦„:
- λ‚μ΄:
- μ„±λ³„:

μ£Όκ΄€μ  μ¦μƒ Subjective Data
- Substructure

κ°κ΄€μ  μ •λ³΄ Objective Data
- Substructure

μ‚¬μ • Assessment
- Substructure

κ³„ν Planning
- Substructure

μ¤‘μ¬ Interventions
- Substructure

ν‰κ°€ Evaluation
- Substructure
###
5. Instead of using numeric order, Use bullet points for the description.
6. Please write as specifically as possible. For example, instead of a generic response like 'μ μ ν• νΈν΅ κΈ°λ²• κµμ΅', provide a more detailed answer such as 'νΈν΅ μ΄λ™ κµμ΅: κΉκ³  μ²μ²ν μ¨μ‰¬κΈ°, λ³µμ‹νΈν΅λ²• κµμ΅'.
7. Record precise numerical data. For example, provide specific details like 'ν™μμ νΈν΅μκ°€ 24μ‹κ°„ μ΄λ‚΄μ— λ¶„λ‹Ή 12~20νλ΅ μ •μƒ λ²”μ„ λ‚΄λ΅ κ°μ†'.
"""
final_prompt_SOAPIE = ChatPromptTemplate.from_messages(
    [
        ("system", instruction_SOAPIE),
        few_shot_prompt_SOAPIE,
        ("human", "{input}"),
    ]
)

# Focus DAR
examples_FocusDAR = [
    {"input": "μ•„μΉ¨ μ‹ν›„ κ³ νλ‹Ή ν™μμ κ°„νΈκΈ°λ΅μ„ Focus DAR μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄\nμ΄λ¦„: κΉ€μ§€μ  \nλ‚μ΄: 65μ„Έ  \nμ„±λ³„: μ—¬μ„±  \n\nν¬μ»¤μ¤ Focus: μ•„μΉ¨ μ‹ν›„ κ³ νλ‹Ή κ΄€λ¦¬  \n\nλ°μ΄ν„° Data\n ν™μλ” 1 ν• λ‹Ήλ‡¨λ³‘μΌλ΅ μΈν•΄ μ…μ› μ¤‘μ΄λ©°, μ•„μΉ¨ μ‹ν›„ νλ‹Ήμ΄ μ •μƒ λ²”μ„λ¥Ό λ²—μ–΄λ‚κ³  μμ.\n μ•„μΉ¨ μ‹ν›„ νλ‹Ή μμΉλ” 200 mg/dLλ΅ μΈ΅μ •λμ—μΌλ©°, ν™μλ” ν”Όλ΅μ™€ λ‘ν†µμ„ νΈμ†ν•¨.\n ν™μλ” νλ‹Ή μ¦κ°€μ™€ κ΄€λ ¨λ λ¶μΎν• μ¦μƒμ„ κ²½ν—ν•λ©°, νλ‹Ή κ΄€λ¦¬μ— λ€ν• μ§€μ†μ μΈ κµμ΅μ΄ ν•„μ”ν•¨.\n μ‹ν›„ νλ‹Ή κ΄€λ¦¬ λ©ν‘μΉλ” 180 mg/dL μ΄ν•μ΄λ©°, ν™μλ” μκ°€ μ£Όμ‚¬λ¥Ό ν†µν• μΈμλ¦° μΉλ£λ¥Ό λ°›κ³  μμ.\n\nν™λ™ Action\n-μ•„μΉ¨ μ‹ν›„ νλ‹Ή μμΉλ¥Ό ν™•μΈν•κ³ , μμ‚¬μ μ§€μ‹μ— λ”°λΌ μΈμλ¦° μΉλ£ κ³„νμ„ μ΅°μ .\n-ν™μμ μ‹μ‚¬ μµκ΄€κ³Ό μ–‘μ„ ν‰κ°€ν•κ³ , μμ–‘μ‚¬μ™€μ ν‘λ ¥μ„ ν†µν•΄ νλ‹Ή μ΅°μ μ„ μ„ν• μ‹μ΄μ”λ²• μλ¦½.\n-νλ‹Ή κ°μ‹λ¥Ό μ„ν•΄ μμ£Ό νλ‹Ήμ„ μΈ΅μ •ν•κ³ , κ·Έ κ²°κ³Όλ¥Ό κΈ°λ΅ν•μ—¬ νλ‹Ή λ³€ν™” μ¶”μ΄λ¥Ό μ§€μ†μ μΌλ΅ ν‰κ°€.\n- ν™μμ—κ² νλ‹Ή κ΄€λ¦¬μ μ¤‘μ”μ„±κ³Ό μ‹ν›„μ— λ°μƒν•  μ μλ” μ¦μƒμ— λ€ν• κµμ΅ μ κ³µ.\n- ν™μμ™€μ λ€ν™”λ¥Ό ν†µν•΄ νλ‹Ή κ΄€λ¦¬μ— λ€ν• μ΄ν•΄λ„λ¥Ό ν™•μΈν•κ³ , ν•„μ” μ‹ μκ°€λ¨λ‹ν„°λ§ κΈ°μ  μ‚¬μ©λ²• κµμ΅.\n\nλ°μ‘ Response\n μΈμλ¦° μΉλ£ κ³„νμ„ μ΅°μ ν• κ²°κ³Ό, μ•„μΉ¨ μ‹ν›„ νλ‹Ήμ΄ 200 mg/dLμ—μ„ 160 mg/dLλ΅ κ°μ†ν•¨.\n νλ‹Ή κ°μ‹λ¥Ό ν†µν•΄ νλ‹Ή λ³€ν™”λ¥Ό μ§€μ†μ μΌλ΅ ν‰κ°€ν•κ³ , μ΅°μ •λ νλ‹Ή κ΄€λ¦¬ κ³„νμ— λ”°λΌ μ•μ •μ μΈ νλ‹Ή μμΉλ¥Ό μ μ§€ν•¨.\n ν™μμ μ‹μ‚¬ μµκ΄€κ³Ό μ–‘μ„ μ΅°μ ν•μ—¬ νλ‹Ή μ΅°μ μ— κΈ°μ—¬ν•κ³ , μμ–‘μ‚¬μ™€μ ν‘λ ¥μ„ ν†µν•΄ μ‹μ΄μ”λ²•μ„ κ°μ„ ν•¨.\n ν™μλ” νλ‹Ή κ΄€λ¦¬μ— λ€ν• μ΄ν•΄λ„κ°€ λ†’μ•„μ Έ μκ°€λ¨λ‹ν„°λ§μ„ μ κ·Ήμ μΌλ΅ μ‹¤μ‹ν•λ©°, νλ‹Ή μ΅°μ μ— μ κ·Ήμ μΌλ΅ μ°Έμ—¬ν•¨.\n ν–¥ν›„ νλ‹Ή κ΄€λ¦¬ κµμ΅κ³Ό μ§€μ†μ μΈ ν‰κ°€λ¥Ό ν†µν•΄ ν™μμ λ‹Ήλ‡¨ κ΄€λ¦¬λ¥Ό μ§€μ›ν•¨."},
    {"input": "μ–‘μ½ λ¬΄λ¦ NRS 6μ  ν™μμ κ°„νΈκΈ°λ΅μ„ Focus DAR μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄\nμ΄λ¦„: λ°•μ„μ§„  \nλ‚μ΄: 55μ„Έ  \nμ„±λ³„: λ‚¨μ„±  \n\nν¬μ»¤μ¤ Focus: μ–‘μ½ λ¬΄λ¦ NRS(λ¬΄λ¦ ν†µμ¦) 6μ   \n\nλ°μ΄ν„° Data\n ν™μλ” μµκ·Όμ— μ–‘μ½ λ¬΄λ¦μ—μ„ μ§€μ†μ μΈ ν†µμ¦μ„ κ²½ν—ν•κ³  μμΌλ©°, NRS(λ¬΄λ¦ ν†µμ¦)λ΅ 6μ μ κ°•λ„λ΅ ν‰κ°€λ¨.\n ν†µμ¦μ€ νΉν μ¤λ«λ™μ• μ•‰μ•„ μκ±°λ‚ μΌμ–΄λ‚  λ• λ” μ‹¬ν•΄μ§€λ” κ²½ν–¥μ΄ μμ.\n ν™μλ” ν†µμ¦μΌλ΅ μΈν•΄ μ‚°μ±…μ΄λ‚ κ³„λ‹¨ μ¤λ¥΄λ‚΄λ¦¬κΈ°κ°€ μ–΄λ ¤μ›μ§€κ³ , ν΄μ‹μ„ μ·¨ν•λ”λΌλ„ ν¨κ³Όκ°€ λ―Έλ―Έν•¨.\n ν†µμ¦μ νΉμ§•μ€ 'λ¬΄κ±°μ›μ§€κ³  μ‘¤μ‹λ”' λλ‚μΌλ΅ ν‘ν„λλ©°, λ¬΄λ¦μ„ κµ½νκ±°λ‚ ν΄λ” κ²ƒμ΄ νλ“¤μ–΄μ§.\n\nν™λ™ Action\n-λ¬΄λ¦ ν†µμ¦μ μ›μΈμ„ ν™•μΈν•κΈ° μ„ν•΄ μμ‚¬μ μ§„μ°°μ„ μλΆ°ν•κ³ , ν•„μ” μ‹ λ¬΄λ¦ κ΄€μ  κ΄€λ ¨ κ²€μ‚¬λ¥Ό μ‹¤μ‹ν•μ—¬ μ§„λ‹¨.\n-ν„μ¬μ ν†µμ¦μ„ μ™„ν™”ν•κΈ° μ„ν•΄ μμ‚¬μ μ²λ°©μ— λ”°λΌ ν†µμ¦ μ™„ν™”μ  λ° ν•­μ—Όμ¦μ  μ²λ°©.\n-λ¬Όλ¦¬μΉλ£μ‚¬μ™€μ ν‘λ ¥μ„ ν†µν•΄ λ¬΄λ¦ κ·Όμ΅μ κ°•λ„ λ° μ μ—°μ„±μ„ ν–¥μƒμ‹ν‚¤λ” μ΄λ™ ν”„λ΅κ·Έλ¨ κ°λ°.\n- ν†µμ¦μ κ°•λ„μ™€ λ°μƒ ν¨ν„΄μ„ μ •ν™•ν κΈ°λ΅ν•κ³ , ν†µμ¦ μ™„ν™”μ  ν¬μ—¬ ν›„ ν¨κ³Όλ¥Ό ν‰κ°€ν•μ—¬ μ²λ°© μ΅°μ .\n- ν™μμ—κ² ν†µμ¦ κ΄€λ¦¬μ— λ€ν• κµμ΅μ„ μ κ³µν•κ³ , μκ°€ λλ΄„ κΈ°μ  κ°•ν™”λ¥Ό μ„ν• μ§€μ› λ° μ •λ³΄ μ κ³µ.\n\nλ°μ‘ Response\n μμ‚¬μ μ§„μ°° κ²°κ³Ό, μ–‘μ½ λ¬΄λ¦μ ν†µμ¦μ€ μ—°κ³¨ μ†μƒμΌλ΅ ν™•μΈλμ–΄ μ μ ν• μΉλ£ μ‹μ‘.\n ν†µμ¦ μ™„ν™”μ μ™€ ν•­μ—Όμ¦μ μ ν¬μ—¬λ΅ ν†µμ¦μ κ°•λ„κ°€ 6μ μ—μ„ 2μ μΌλ΅ κ°μ†ν•λ©°, μΌμƒ μƒν™μ— λ€ν• μ ν•μ΄ μ™„ν™”λ¨.\n λ¬Όλ¦¬μΉλ£λ¥Ό ν†µν•΄ λ¬΄λ¦ κ·Όμ΅μ κ°•λ„ λ° μ μ—°μ„±μ΄ ν–¥μƒλμ–΄ λ³΄ν–‰μ΄ μμ›”ν•΄μ§€κ³ , ν™μμ ν™λ™λ‰μ΄ μ¦κ°€ν•¨.\n ν™μλ” ν†µμ¦ κ΄€λ¦¬μ— λ€ν• μ΄ν•΄λ„κ°€ λ†’μ•„μ Έ μ²λ°©λ μΉλ£ κ³„νμ— μ κ·Ήμ μΌλ΅ ν‘λ ¥ν•¨.\n ν–¥ν›„ μμ‚¬μ μ§€μ‹μ— λ”°λΌ μ •κΈ°μ μΈ μ¶”μ  κ΄€μ°°κ³Ό ν‰κ°€λ¥Ό ν†µν•΄ μΉλ£ ν¨κ³Όλ¥Ό λ¨λ‹ν„°λ§ν•¨."},
    {"input": "ν†µμ¦κ΄€λ¦¬ ν™μμ κ°„νΈκΈ°λ΅μ„ Focus DAR μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄\nμ΄λ¦„: λ°•μ¤€ν  \nλ‚μ΄: 60μ„Έ  \nμ„±λ³„: λ‚¨μ„±  \n\nν¬μ»¤μ¤ Focus: λ¥λ§ν‹°μ¤ κ΄€μ μ—ΌμΌλ΅ μΈν• κ΄€μ  ν†µμ¦  \n\nλ°μ΄ν„° Datan ν™μλ” λ‡ λ…„ λ™μ• λ¥λ§ν‹°μ¤ κ΄€μ μ—ΌμΌλ΅ μΈν• κ΄€μ  ν†µμ¦μ„ κ²½ν—ν•κ³  μμΌλ©°, ν„μ¬ ν†µμ¦μ κ°•λ„λ” NRSλ΅ 7μ μΌλ΅ ν‰κ°€λ¨.\n ν†µμ¦μ€ μ£Όλ΅ μ–΄κΉ¨, ν”κΏμΉ, λ¬΄λ¦ κ΄€μ μ— μ§‘μ¤‘λμ–΄ μμΌλ©°, νΉν μ•„μΉ¨μ— μΌμ–΄λ‚  λ• λ”μ± λλ ·ν•΄μ§.\n ν™μλ” ν†µμ¦μΌλ΅ μΈν•΄ μΌμƒ μƒν™μ—μ„μ ν™λ™μ΄ μ ν•λκ³ , νΉν κ³„λ‹¨ μ¤λ¥΄λ‚΄λ¦΄ λ• ν†µμ¦μ΄ μ¦κ°€ν•¨.\n ν„μ¬κΉμ§€ λ‹¤μ–‘ν• μ•½λ¬Ό μΉλ£ λ° λ¬Όλ¦¬μΉλ£λ¥Ό μ‹λ„ν•μ€μΌλ‚, ν¨κ³Όκ°€ λ―Έλ―Έν•¨.\n\nν™λ™ Action\n-μμ‚¬μ μ§„μ°°μ„ μλΆ°ν•μ—¬ λ¥λ§ν‹°μ¤ κ΄€μ μ—Όμ ν™λ™μ„± λ° κ΄€μ  μ†μƒ μ •λ„λ¥Ό ν‰κ°€ν•κ³ , ν„μ¬ ν†µμ¦μ— λ€ν• μ μ ν• μΉλ£ κ³„ν μλ¦½.\n-ν†µμ¦ κ°•λ„μ™€ μ„μΉλ¥Ό μ •ν™•ν κΈ°λ΅ν•κ³ , μμ‚¬μ μ²λ°©μ— λ”°λΌ ν†µμ¦ μ™„ν™”μ  λ° λ©΄μ—­μ–µμ μ  λ“±μ μ•½λ¬Ό μ²λ°©.\n-λ¬Όλ¦¬μΉλ£μ‚¬μ™€μ ν‘λ ¥μ„ ν†µν•΄ κ΄€μ μ„ μ•μ •μ‹ν‚¤κ³ , κ΄€μ  μ΄λ™ λ²”μ„λ¥Ό ν™•λ€ν•λ” μ΄λ™ ν”„λ΅κ·Έλ¨ μ‹¤μ‹.\n- ν™μμ—κ² ν†µμ¦ κ΄€λ¦¬ μ „λµμ— λ€ν• κµμ΅μ„ μ κ³µν•κ³ , μκ°€ λλ΄„ κΈ°μ  κ°•ν™”λ¥Ό μ„ν• μ§€μ› λ° μ •λ³΄ μ κ³µ.\n- ν†µμ¦μ κ°•λ„μ™€ κ΄€μ  μƒνƒλ¥Ό μ •κΈ°μ μΌλ΅ ν‰κ°€ν•κ³ , μμ‚¬μ™€ ν•¨κ» μΉλ£ κ³„νμ„ μ΅°μ ν•μ—¬ ν¨κ³Όμ μΈ ν†µμ¦ κ΄€λ¦¬.\n\nλ°μ‘ Response\n μμ‚¬μ μ§„μ°° κ²°κ³Ό, λ¥λ§ν‹°μ¤ κ΄€μ μ—Όμ ν™λ™μ„±μ΄ λ†’μ•„\n\n κ΄€μ  μ†μƒμ΄ μ§„ν–‰λκ³  μμμ„ ν™•μΈν•κ³ , μ μ ν• μΉλ£ μ‹μ‘.\n ν†µμ¦ μ™„ν™”μ μ™€ λ©΄μ—­μ–µμ μ μ ν¬μ—¬λ΅ ν†µμ¦μ κ°•λ„κ°€ 7μ μ—μ„ 2μ μΌλ΅ κ°μ†ν•λ©°, ν™μμ μΌμƒ μƒν™μ— λ€ν• μ μ•½μ΄ μ™„ν™”λ¨.\n λ¬Όλ¦¬μΉλ£λ¥Ό ν†µν•΄ κ΄€μ μ μ•μ •μ„±μ΄ ν–¥μƒλμ–΄ κ΄€μ  μ΄λ™ λ²”μ„κ°€ ν™•λ€λκ³ , ν™μμ ν™λ™ λ¥λ ¥μ΄ ν–¥μƒλ¨.\n ν™μλ” ν†µμ¦ κ΄€λ¦¬μ— λ€ν• μ΄ν•΄λ„κ°€ λ†’μ•„μ Έ μ²λ°©λ μΉλ£ κ³„νμ— μ κ·Ήμ μΌλ΅ ν‘λ ¥ν•¨.\n ν–¥ν›„ μμ‚¬μ μ§€μ‹μ— λ”°λΌ μ •κΈ°μ μΈ μ¶”μ  κ΄€μ°°κ³Ό ν‰κ°€λ¥Ό ν†µν•΄ μΉλ£ ν¨κ³Όλ¥Ό λ¨λ‹ν„°λ§ν•¨."},
    {"input": "μ„±μΈμ•μ°½ λ° λ‚™μƒ μ„ν— ν™μμ κ°„νΈκΈ°λ΅μ„ Focus DAR μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄\nμ΄λ¦„: λ°•μ§€μ  \nλ‚μ΄: 68μ„Έ  \nμ„±λ³„: μ—¬μ„±  \n\nν¬μ»¤μ¤ Focus: μ„±μΈ μ•μ°½ λ° λ‚™μƒ μ„ν—  \n\nλ°μ΄ν„° Data\n ν™μλ” μƒνƒ μ•…ν™”λ΅ μΉ¨μƒμ΄ ν•„μ”ν• μƒνƒλ΅ μ…μ› μ¤‘μ΄λ©°, μ„±μΈ μ•μ°½μ μ„ν—μ„±μ΄ λ†’μ.\n μ΄κΈ° ν”Όλ¶€ ν‰κ°€μ—μ„ μ—‰λ©μ΄μ™€ κ³ κ΄€μ  λ¶€μ„μ—μ„ λ¶‰μ€ μƒ‰ λ³€ν™”κ°€ ν™•μΈλμ—μΌλ©°, ν”Όλ¶€ ν‘λ©΄μ΄ λ¶€μ–΄μμ–΄ λ¶€λ“λ½κ² λκ»΄μ§.\n ν™μλ” μ•“κ³  μλ” μ§ν™μΌλ΅ μΈν•΄ μ›€μ§μ΄λ” κ²ƒμ΄ μ–΄λ ¤μ°λ©°, μ²΄μ¤‘ κ°μ†μ™€ κΈ°λ¥ μ €ν•λ΅ μΌμƒ μƒν™μ—μ„μ ν™λ™μ΄ μ ν•λμ–΄ μμ.\n λ‚™μƒ μ„ν— ν‰κ°€μ—μ„λ” ν™μκ°€ μ΄λ™ν•  λ•λ‚ μΌμ–΄μ„λ” λ™μ•μ— κ· ν•μ„ μ μ§€ν•κΈ° μ–΄λ ¤μ΄ μƒνƒμ„.\n\nν™λ™ Action\n-ν”Όλ¶€ μƒνƒλ¥Ό μ •κΈ°μ μΌλ΅ λ¨λ‹ν„°λ§ν•κ³ , μ••λ ¥μ„ μµμ†ν™”ν•λ” μΏ μ… λ° λ§¤νΈλ¦¬μ¤ μ‚¬μ©μ„ ν†µν•΄ μλ°© μ΅°μΉ μ‹¤μ‹.\n-κ°„νΈμ‚¬μ™€ λ¬Όλ¦¬μΉλ£μ‚¬μ ν‘λ ¥μ„ ν†µν•΄ ν™μμ μ²΄μ„λ¥Ό μ£ΌκΈ°μ μΌλ΅ λ³€κ²½ν•κ³ , μ²΄μ¤‘ κ°μ†λ¥Ό λ°©μ§€ν•λ” μΉλ£ κ³„ν μλ¦½.\n-λ³΄μ΅° κΈ°κµ¬ μ‚¬μ© κµμ΅ λ° ν™μμ μ΄λ™κ³Ό κ΄€λ ¨λ μ•μ „ν• κΈ°μ μ„ ν•™μµμ‹μΌ λ‚™μƒ μ„ν—μ„ μµμ†ν™”.\n4. κ°€μ΅±μ΄λ‚ λ³΄νΈμμ—κ² ν™μμ μΉ¨μƒ μƒνƒμ™€ μ΄λ™μ— λ€ν• μ§€μ†μ μΈ κ°λ…μ„ λ¶€νƒν•κ³ , λ‚™μƒ μλ°©μ„ μ„ν• ν™κ²½ κ°μ„  κµμ΅.\n- μμ‚¬μ™€ ν‘λ ¥ν•μ—¬ κΈ°μ €μ§ν™μ μΉλ£ λ° μμ–‘ μƒνƒλ¥Ό κ°μ„ ν•κ³ , ν™μμ μΌμƒ ν™λ™ μν–‰μ„ μ§€μ›ν•λ” μΆ…ν•©μ μΈ μΉλ£ μ „λµ μλ¦½.\n\nλ°μ‘ Response\n ν”Όλ¶€ μƒνƒμ λ¨λ‹ν„°λ§ κ²°κ³Ό, μ΄κΈ°μ— λ°κ²¬λ μ••λ ¥ μ μ ν”Όλ¶€ λ³€ν™”κ°€ μλ°© μ΅°μΉλ¥Ό ν†µν•΄ νΈμ „λμ—μ.\n μΏ μ… λ° λ§¤νΈλ¦¬μ¤μ μ‚¬μ©μΌλ΅ ν”Όλ¶€μ λ¶€μΆ…μ΄ κ°μ†ν•κ³ , ν”Όλ¶€\n\n ν‘λ©΄μ΄ λ¶€λ“λ½κ² νλ³µλμ—μ.\n ν™μλ” μ μ ν• κΈ°μ μ„ μ‚¬μ©ν•μ—¬ μΉ¨μƒ λ° μ΄λ™ μ¤‘μ λ‚™μƒ μ„ν—μ„ ν¨κ³Όμ μΌλ΅ κ΄€λ¦¬ν•¨.\n λ³΄μ΅°κΈ°κµ¬ μ‚¬μ©κ³Ό ν™κ²½ κ°μ„ μ„ ν†µν•΄ λ‚™μƒ μ„ν—μ΄ μµμ†ν™”λμ–΄, ν™μμ μΌμƒ ν™λ™ μν–‰μ΄ μ•μ „ν•κ² μ΄λ£¨μ–΄μ§€κ³  μμ.\n κ°€μ΅± λ° λ³΄νΈμλ” ν™μμ μΉ¨μƒκ³Ό μ΄λ™μ— λ€ν• μ§€μ†μ μΈ κ°λ…μ„ μν–‰ν•κ³ , μ‘κΈ‰ μƒν™© μ‹ μ‹ μ†ν• μ΅°μΉλ¥Ό μ·¨ν•  μ μλ” λ¥λ ¥μ„ ν–¥μƒμ‹μΌ°μ."}
]
few_shot_prompt_FocusDAR = FewShotChatMessagePromptTemplate(
    example_prompt=example_prompt,
    examples=examples_FocusDAR 
)
instruction_FocusDAR = """
You are a 5th nurse working in a general hospital. Answer the question, adhering to the following guidelines:
1. Write in Korean
2. Utilize the information available in the prompt. If relevant information is not found there, then seek answers through other channels.
3. Use precise and concise language. Use endings like μ, ν•¨, μ„.
4. Necessary to write a nursing record following this format.
###
ν™μ μ •λ³΄
- μ΄λ¦„:
- λ‚μ΄:
- μ„±λ³„:

ν¬μ»¤μ¤ Focus
- Substructure

λ°μ΄ν„° Data
- Substructure

ν™λ™ Action
- Substructure

λ°μ‘ Response
- Substructure
###
5. Instead of using numeric order, Use bullet points for the description.
6. Please write as specifically as possible. For example, instead of a generic response like 'μ μ ν• νΈν΅ κΈ°λ²• κµμ΅', provide a more detailed answer such as 'νΈν΅ μ΄λ™ κµμ΅: κΉκ³  μ²μ²ν μ¨μ‰¬κΈ°, λ³µμ‹νΈν΅λ²• κµμ΅'.
7. Record precise numerical data. For example, provide specific details like 'ν™μμ νΈν΅μκ°€ 24μ‹κ°„ μ΄λ‚΄μ— λ¶„λ‹Ή 12~20νλ΅ μ •μƒ λ²”μ„ λ‚΄λ΅ κ°μ†'.
"""
final_prompt_FocusDAR = ChatPromptTemplate.from_messages(
    [
        ("system", instruction_FocusDAR),
        few_shot_prompt_FocusDAR,
        ("human", "{input}"),
    ]
)

# NN
examples_NN = [
    {"input": "μλ°μ  ν™κΈ°μ¥μ•  ν™μμ κ°„νΈκΈ°λ΅μ„ Narrative Note μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μλ…: μ •λ―ΌνΈ, λ‚¨μ„±, 56μ„Έ\n\nμ •λ―ΌνΈ μ”¨λ” μλ°μ  ν™κΈ°μ¥μ• λ΅ μΈν•΄ μ…μ›ν•¨. ν™μλ” νΈν΅ μ‹ ν‰λ¶€ μ••λ°•κ°μ„ νΈμ†ν•λ©°, νΈν΅μ΄ μ–•κ³  λΉ λ¥΄κ² κ΄€μ°°λ¨. νΈν΅μλ” λ¶„λ‹Ή 30νλ΅ μΈ΅μ •λ¨. ν™μλ” μΌμƒ ν™λ™ μ¤‘μ—λ„ νΈν΅κ³¤λ€μ„ κ²κ³  μμΌλ©°, λ¶μ•κ°μ„ ν‘ν„ν•¨.\n\nκ°„νΈ μ¤‘μ¬λ΅λ” μ •κΈ°μ μΈ νΈν΅ λ¨λ‹ν„°λ§κ³Ό μ‚°μ†ν¬ν™”λ„ μΈ΅μ •μ„ μ‹¤μ‹ν•¨. ν™μμ—κ² κΉκ² μ¨μ‰¬κΈ° λ° λ³µμ‹νΈν΅λ²•μ„ κµμ΅ν•¨. μ΄μ™„ κΈ°λ²•κ³Ό μ¤νΈλ μ¤ κ΄€λ¦¬ μ „λµμ„ μ•λ‚΄ν•μ—¬ ν™μκ°€ λ¶μ•κ°μ„ μ¤„μΌ μ μλ„λ΅ ν•¨. ν•„μ”μ— λ”°λΌ μ‚°μ† μ”λ²•μ„ μ‹¤μ‹ν•μ—¬ νΈν΅μ„ λ•κ³ , ν™μμ μ•μ„λ¥Ό μ„ν•΄ μ μ ν• ν™κ²½μ„ μ΅°μ„±ν•¨.\n\nμ¤ν›„ ν‰κ°€μ—μ„ μ •λ―ΌνΈ μ”¨μ νΈν΅μλ” νΈν΅ μ΄λ™ λ° μ΄μ™„ κΈ°λ²• μ μ© ν›„ λ¶„λ‹Ή 24νλ΅ κ°μ†ν•¨μ„ ν™•μΈν•¨. μ‚°μ†ν¬ν™”λ„λ” 95%λ΅ κ°μ„ λ¨. ν™μλ” μ΄μ™„ κΈ°λ²•μ„ ν†µν•΄ λ¶μ•κ°μ΄ κ°μ†ν–λ‹¤κ³  λλ‚. μ§€μ†μ μΈ λ¨λ‹ν„°λ§κ³Ό μ μ ν• μ¤‘μ¬λ¥Ό ν†µν•΄ ν™μμ νΈν΅ μƒνƒμ™€ μ „λ°μ μΈ μ•μ„λ¥Ό κ°μ„ ν•λ” λ° μ¤‘μ μ„ λ‘κ³  μμ."},
    {"input": "κΈ‰μ„±ν†µμ¦ ν™μμ κ°„νΈκΈ°λ΅μ„ Narrative Note μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μλ…: κΉ€λ‹¤ν„, μ—¬μ„±, 33μ„Έ\n\nκΉ€λ‹¤ν„ μ”¨λ” λ³µλ¶€ μμ  ν›„ κΈ‰μ„±ν†µμ¦μΌλ΅ μΈν•΄ μ…μ›ν•¨. ν™μλ” μμ  λ¶€μ„μ— μ‹¬ν• ν†µμ¦μ„ νΈμ†ν•λ©°, ν†µμ¦ μ μλ” 9/10μΌλ΅ λ³΄κ³ λ¨. ν™μλ” ν†µμ¦μΌλ΅ μΈν•΄ μ ν•λ μ›€μ§μ„κ³Ό λ¶νΈν• μμ„Έλ¥Ό μ·¨ν•κ³  μμ.\n\nκ°„νΈ μ¤‘μ¬λ΅λ” μμ‚¬μ μ§€μ‹μ— λ”°λΌ μ •κΈ°μ μΈ μ§„ν†µμ  ν¬μ—¬λ¥Ό μ‹¤μ‹ν•¨. ν™μμ—κ² ν¨κ³Όμ μΈ ν†µμ¦ κ΄€λ¦¬ κΈ°λ²•, μλ¥Ό λ“¤μ–΄ νΈν΅ μ΄λ™κ³Ό μ΄μ™„ κΈ°λ²•μ„ κµμ΅ν•¨. μμ  λ¶€μ„λ¥Ό μ§€μ†μ μΌλ΅ κ΄€μ°°ν•κ³ , ν†µμ¦μ΄ μ™„ν™”λ  μ μλ„λ΅ μ μ ν• μ²΄μ„ λ³€ν™”λ¥Ό κ¶μ¥ν•¨. ν™μμ ν†µμ¦ μ™„ν™”λ¥Ό μ„ν•΄ μ •μ„μ  μ§€μ§€λ¥Ό μ κ³µν•¨.\n\nμ¤ν›„ ν‰κ°€μ—μ„ κΉ€λ‹¤ν„ μ”¨μ ν†µμ¦ μ μλ” 6/10μΌλ΅ κ°μ†ν•¨μ„ ν™•μΈν•¨. ν™μλ” μ κ³µλ ν†µμ¦ κ΄€λ¦¬ κΈ°λ²•μ„ μ μ©ν•μ—¬ ν†µμ¦μ΄ λ‹¤μ† κ²½κ°λ¨μ„ λ³΄κ³ ν•¨. μμ  λ¶€μ„μ μƒνƒλ” μ•μ •μ μ΄λ©°, μ¶”κ°€μ μΈ ν•©λ³‘μ¦μ€ κ΄€μ°°λμ§€ μ•μ. μ§€μ†μ μΈ λ¨λ‹ν„°λ§κ³Ό μ μ ν• μ¤‘μ¬λ¥Ό ν†µν•΄ ν™μμ ν†µμ¦ κ΄€λ¦¬μ™€ νλ³µμ„ μ§€μ›ν•  κ³„νμ„."},
    {"input": "κ³ μ²΄μ¨ ν™μμ κ°„νΈκΈ°λ΅μ„ Narrative Note μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μλ…: μ¤μ„±λ―Ό, λ‚¨μ„±, 40μ„Έ\n\nμ¤μ„±λ―Ό μ”¨λ” κ³ μ—΄λ΅ μΈν• κ³ μ²΄μ¨μΌλ΅ μ…μ›ν•¨. μ…μ› λ‹Ήμ‹ μ²΄μ¨μ€ 39.5Β°Cλ΅ μΈ΅μ •λμ—μΌλ©°, ν™μλ” μ¤ν•κ³Ό λ‘ν†µμ„ νΈμ†ν•¨. ν™μλ” μµκ·Ό κ°κΈ° μ¦μƒμ΄ μμ—μΌλ©°, κ³ μ—΄λ΅ μΈν• μ „λ°μ μΈ λ¬΄λ ¥κ°μ„ λλ‚.\n\nκ°„νΈ μ¤‘μ¬λ΅λ” ν™μμ μ²΄μ¨ λ¨λ‹ν„°λ§μ„ μ •κΈ°μ μΌλ΅ μ‹¤μ‹ν•κ³ , ν•΄μ—΄μ λ¥Ό μμ‚¬μ μ§€μ‹μ— λ”°λΌ ν¬μ—¬ν•¨. ν™μμ—κ² μ¶©λ¶„ν• μλ¶„ μ„­μ·¨λ¥Ό κ¶μ¥ν•κ³ , μ μ ν• ν™κΈ°μ™€ μ‹¤λ‚΄ μ¨λ„ μ΅°μ μ„ ν†µν•΄ μ²΄μ¨ μ΅°μ μ„ λ•λ„λ΅ ν•¨. λν•, ν™μμ μ „λ°μ μΈ μƒνƒλ¥Ό κ΄€μ°°ν•λ©°, κ°μ—Όμ μ§•ν›„λ¥Ό λ¨λ‹ν„°λ§ν•¨.\n\nμ¤ν›„ ν‰κ°€μ—μ„ μ¤μ„±λ―Ό μ”¨μ μ²΄μ¨μ€ 38.2Β°Cλ΅ κ°μ†ν•¨. ν™μλ” ν•΄μ—΄μ  ν¬μ—¬ ν›„ μ¤ν•κ³Ό λ‘ν†µμ΄ μ¤„μ–΄λ“¤μ—μμ„ λ³΄κ³ ν•¨. μλ¶„ μ„­μ·¨μ™€ μ μ ν• ν™κ²½ μ΅°κ±΄ μ΅°μ μ΄ ν™μμ λ¶νΈν•¨μ„ μ™„ν™”ν•λ” λ° λ„μ›€μ΄ λ¨. μ§€μ†μ μΈ λ¨λ‹ν„°λ§κ³Ό μ μ ν• μ¤‘μ¬λ¥Ό ν†µν•΄ ν™μμ κ³ μ²΄μ¨ μƒνƒμ™€ μ „λ°μ μΈ μ•μ„λ¥Ό κ΄€λ¦¬ν•  κ³„νμ„."},
    {"input": "λ¶„λ§ν†µμ¦ ν™μμ κ°„νΈκΈ°λ΅μ„ Narrative Note μ–‘μ‹μΌλ΅ μ‘μ„±ν•΄μ¤.", "output": "ν™μ μ •λ³΄ κΉ€μ€μ§€, 28μ„Έ, μ—¬μ„±\n\nκ°„νΈ κΈ°λ΅:\n\nκΉ€μ€μ§€ ν™μλ” λ¶„λ§ μ΄κΈ° λ‹¨κ³„μ—μ„ μ‹¬ν• ν†µμ¦μ„ νΈμ†ν•¨. μ¤μ „ 11μ‹ ν™μμ μκ¶ μμ¶•μ€ 10λ¶„ κ°„κ²©μΌλ΅ λ°μƒν•λ©°, ν†µμ¦ κ°•λ„λ” 10μ  λ§μ μ— 7μ μΌλ΅ ν‰κ°€λ¨.\n\nν™μλ” λ¶μ•κ³Ό μ¤νΈλ μ¤λ¥Ό ν‘ν„ν•¨. ν™μμ—κ² μ΄μ™„ νΈν΅λ²•κ³Ό μ¤νΈλ μ¤ κ΄€λ¦¬ κΈ°λ²•μ„ κµμ΅ν•¨. λ”°λ»ν• λ¬Όλ΅ μ¤ν°μ§€ λ©μ•μ„ μ κ³µν•μ—¬ μ΄μ™„μ„ λ„μ›€.\n\nμμ‚¬μ μ§€μ‹μ— λ”°λΌ ν•„μ”μ‹ μ§„ν†µμ  ν¬μ—¬λ¥Ό μ¤€λΉ„ν•¨. ν™μμ—κ² λ¶„λ§ κ³Όμ •κ³Ό ν†µμ¦ κ΄€λ¦¬μ— λ€ν• μ •λ³΄λ¥Ό μ κ³µν•μ—¬ μ•μ‹¬μ‹ν‚΄.\n\nμ¤μ „ 11:45μ— ν™μ μƒνƒ μ¬ν‰κ°€ κ²°κ³Ό, μκ¶ μμ¶•μ€ 8λ¶„ κ°„κ²©μΌλ΅ μ μ§€λκ³ , ν™μλ” μ΄μ™„ νΈν΅λ²•μ„ ν†µν•΄ ν†µμ¦ κ΄€λ¦¬μ— λ„μ›€μ„ λ°›μ•λ‹¤κ³  λ³΄κ³ ν•¨.\n\nκ³„ν:\n\nλ¶„λ§ μ§„ν–‰ μƒν™©κ³Ό ν†µμ¦ μμ¤€μ„ μ§€μ†μ μΌλ΅ λ¨λ‹ν„°λ§ν•¨.\nν™μμ—κ² μ΄μ™„ νΈν΅λ²•κ³Ό μ¤νΈλ μ¤ κ΄€λ¦¬λ¥Ό μ§€μ†μ μΌλ΅ κ¶μ¥ν•¨.\nν•„μ”μ— λ”°λΌ μ¶”κ°€μ μΈ μ§„ν†µ κ΄€λ¦¬λ¥Ό μ‹¤μ‹ν•¨.\nν™μμ™€ μμ‚¬ μ‚¬μ΄μ μ›ν™ν• μ»¤λ®¤λ‹μΌ€μ΄μ…μ„ μ μ§€ν•μ—¬ λ¶„λ§ κ³Όμ •μ„ μ§€μ›ν•¨."}
]
few_shot_prompt_NN = FewShotChatMessagePromptTemplate(
    example_prompt=example_prompt,
    examples=examples_NN 
)
instruction_NN = """
You are a 5th nurse working in a general hospital. Answer the question, adhering to the following guidelines:
1. Write in Korean
2. Use precise and concise language. Use endings like μ, ν•¨, μ„.
3. Utilize the information available in the prompt. If relevant information is not found there, then seek answers through other channels.
4. Necessary to write a nursing record following this format.
###
ν™μ μ •λ³΄
- μ΄λ¦„:
- λ‚μ΄:
- μ„±λ³„:

μ„μ  κΈ°λ΅ Narrative Notes

κ³„ν Plan
- 
###
5. Instead of using numeric order, Use bullet points for the description.
6. Please write as specifically as possible. For example, instead of a generic response like 'μ μ ν• νΈν΅ κΈ°λ²• κµμ΅', provide a more detailed answer such as 'νΈν΅ μ΄λ™ κµμ΅: κΉκ³  μ²μ²ν μ¨μ‰¬κΈ°, λ³µμ‹νΈν΅λ²• κµμ΅'.
7. Record precise numerical data. For example, provide specific details like 'ν™μμ νΈν΅μκ°€ 24μ‹κ°„ μ΄λ‚΄μ— λ¶„λ‹Ή 12~20νλ΅ μ •μƒ λ²”μ„ λ‚΄λ΅ κ°μ†'.
"""
final_prompt_NN = ChatPromptTemplate.from_messages(
    [
        ("system", instruction_NN),
        few_shot_prompt_NN,
        ("human", "{input}"),
    ]
)

# μ±„ν… UI

st.title("π‘©β€β•οΈ Smart Nurse ENR Chatbot")
st.subheader('μ¤λ§νΈλ„μ¤ ENR μ±—λ΄‡μ—κ² λ„μ›€μ„ μ”μ²­ν•μ„Έμ”.')
st.markdown('μ§λ³‘κ³Ό μ–‘μ‹μ„ μ…λ ¥ν•λ©΄ κ°„νΈ κΈ°λ΅ μμ‹κ°€ μƒμ„±λ©λ‹λ‹¤.\n μ™Όμ½ μ‚¬μ΄λ“λ°”λ¥Ό μ—΄μ–΄ μ–‘μ‹μ„ μ„ νƒν•΄ μ£Όμ„Έμ”.')
# cssλ΅ κΎΈλ―ΈκΈ°
st.markdown("""
<style>

h1{
    color : rgb(6 161 54);
    }
    
.st-emotion-cache-fg4pbf {
    background: rgb(238, 250, 242);
    color : rgb(128, 132, 149);
    }

.st-bx {
    background-color : rgba(255, 255, 255, 0.95);
    }


.st-emotion-cache-4oy321 {
    background-color : rgb(113, 212, 194 / 57%);
    }
    


.st-emotion-cache-vk3wp9 {
    background-color:rgb(190 191 200 / 85%);
    }

.st-emotion-cache-90vs21 {
    background-color : rgb(238, 250, 242);
    }

}

   
</style> 
""", unsafe_allow_html=True)



# Using "with" notation
with st.sidebar:
    format = ['NANDA', 'SOAPIE', 'Focus DAR', 'Narrative Note']
    format_option = st.selectbox("", format,
        index=None,
        placeholder="κΈ°λ΅ μ–‘μ‹μ„ μ„ νƒν•΄ μ£Όμ„Έμ”.",
        label_visibility="visible",
        # on_change=,
        # options=,
        )
    st.write('μ„ νƒ: ', format_option)
        


# λ©”μ‹μ§€ μ…λ ¥ λ° μ²λ¦¬
if 'messages' not in st.session_state:
    st.session_state["messages"] = []

paint_history()

def handle_chat(message, format_option):
    if format_option == 'NANDA':
        prompt = final_prompt_NANDA
    elif format_option == 'SOAPIE':
        prompt = final_prompt_SOAPIE
    elif format_option == 'Focus DAR':
        prompt = final_prompt_FocusDAR
    elif format_option == 'Narrative Note':
        prompt = final_prompt_NN
    else:
        st.error("Invalid format option selected.")
        return None

    send_message(message, "human")
    chain = prompt | azure
    return chain.invoke({"input": message, "output": ""})

message = st.chat_input("μμ‹: ν†µμ¦ ν™μμ κ°„νΈκΈ°λ΅μ„ μ‘μ„±ν•΄μ¤.")
if message:
    response = handle_chat(message, format_option)
        
