# ìµœì¢… ë°œí‘œ í˜ì´ì§€

**NANDA 2.0 :** ì‹¤ìŠµìš© ì „ìê°„í˜¸ê¸°ë¡ì‹œìŠ¤í…œ LLM ì ìš© / ì „ìê°„í˜¸ê¸°ë¡ ë¬¸êµ¬ ì‘ë™ ì‘ì„± ì‹œìŠ¤í…œ 

ğŸ€íŒ€ì¥ : í™©ì¬ì—°

â˜˜ï¸íŒ€ì› : ì•ˆì§€ì€, í™ì„¸í—Œ, ë°•ì•„ì˜

ğŸ—„ï¸Repository : [https://github.com/SmartNurse/Year_Dream](https://github.com/SmartNurse/Year_Dream)

---

- **ëª©ì°¨**
    1. [í”„ë¡œì íŠ¸ ê°œìš”](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b.md)
    2. [ë°ì´í„° EDA](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b.md)
        1. ë°ì´í„° í˜„í™©
        2. 1ì°¨ ì „ì²˜ë¦¬
        3. 2ì°¨ ì „ì²˜ë¦¬
        4. LLM í•™ìŠµ ë°ì´í„°ì…‹ ì œì‘
    3. [Model : Fine-tuning & LLM í•™ìŠµ](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b.md)
        1. GPT API : Microsoft Azure Open AI
        2. GPT Fine-tuning
        3. LLM í•™ìŠµ
    4. [ì„œë¹„ìŠ¤ êµ¬í˜„ ë° ë°°í¬](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b.md)
        1. Chatbot : Langchain 
        2. Webapp deployment : Streamlit 
    

# 1. í”„ë¡œì íŠ¸ **ê°œìš”**

âœ¨í”„ë¡œì íŠ¸ í•„ìš”ì„± (ë¬¸ì œ ì œì‹œ)

![á„‡á…¡á†¯á„‘á…­á„Œá…¡á„…á…­.001.png]
(./Smart_nurse_Chatbot/%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%E1%84%8C%E1%85%A1%E1%84%85%E1%85%AD.001.png)

![ê°„í˜¸ëŒ€í•™ìƒ ë° ì‹ ê·œê°„í˜¸ì‚¬ë¥¼ ìœ„í•œ DK Medi Info ì˜ Smart Nurse ENR ì‹œìŠ¤í…œ](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-12-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_6.02.38.png)

ê°„í˜¸ëŒ€í•™ìƒ ë° ì‹ ê·œê°„í˜¸ì‚¬ë¥¼ ìœ„í•œ DK Medi Info ì˜ Smart Nurse ENR ì‹œìŠ¤í…œ

### **âœ¨í”„ë¡œì íŠ¸ ëª©í‘œ**

- ì „ì ê°„í˜¸ê¸°ë¡ ë°ì´í„° ê¸°ë°˜ ì‹¤ìŠµìš© ì „ì ê°„í˜¸ê¸°ë¡ ë¬¸êµ¬ ìë™ ìƒì„± ì±—ë´‡ ì‹œìŠ¤í…œ êµ¬í˜„

### âœ¨Work Flow

- **ë°ì´í„° ì „ì²˜ë¦¬ â†’ LLM ëª¨ë¸ Fine-tuning  â†’ Prompt fine-tuning â†’ ì±—ë´‡ ì„œë¹„ìŠ¤ êµ¬í˜„ â†’ ì›¹ì•± ë°°í¬**
    
    ![work flow](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/work_flow.001.png)
    
    work flow
    

### âœ¨ì‚¬ìš©í•œ íˆ´

- GPT-3.5 turbo (Azure Open AI) : Pretrained LLM Model
- (í•˜ì´í¼í´ë¡œë°”X) : Pretrained LLM Model
- Langchain : Chatbot implementation
- Streamlit : Webapp deployment

### âœ¨Â ìš©ì–´ ì„¤ëª…

- ìŠ¤ë§ˆíŠ¸ë„ìŠ¤ì—ì„œ ì œê³µí•˜ëŠ” ì£¼ìš” ê°„í˜¸ê¸°ë¡ ì–‘ì‹
    - NANDA : ë¶ë¯¸ ê°„í˜¸í˜‘íšŒ í‘œì¤€ ì§„ë‹¨ì´ í¬í•¨ëœ ê¸°ë¡ ì²´ê³„
        - [domain, class, diagnosis, ìë£Œ, ê°„í˜¸ ëª©í‘œ, ê°„í˜¸ ê³„íš] ë“± í¬í•¨
    - SOAPIE : ë¬¸ì œì¤‘ì‹¬ ê¸°ë¡ì²´ê³„
        - [ì£¼ê´€ì  ìë£Œ, ê°ê´€ì  ìë£Œ, ê°„í˜¸ì‚¬ì •, ê°„í˜¸ê³„íš, ì¤‘ì¬, í‰ê°€] ë‚´ìš© í¬í•¨
    - Focus DAR : í•µì‹¬ ì¤‘ì‹¬ ê¸°ë¡ì²´ê³„
        - [í•µì‹¬, ìë£Œ(ì£¼ê´€ì /ê°ê´€ì ), ê°„í˜¸í™œë™, í™˜ìë°˜ì‘] ë‚´ìš© í¬í•¨
    - ì„œìˆ ê¸°ë¡(Narrative Note) : ì‹œê°„ ê²½ê³¼ì— ë”°ë¥¸ ì „í†µì ì¸ ê¸°ë¡ë°©ë²•
    
    ![ìŠ¤ë§ˆíŠ¸ë„ìŠ¤ ì‹œìŠ¤í…œ ê°„í˜¸ê¸°ë¡ ì–‘ì‹ ì˜ˆì‹œ](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/record.001.png)
    
    ìŠ¤ë§ˆíŠ¸ë„ìŠ¤ ì‹œìŠ¤í…œ ê°„í˜¸ê¸°ë¡ ì–‘ì‹ ì˜ˆì‹œ
    

# 2. ë°ì´í„° EDA

### a. ë°ì´í„° í˜„í™©

- DK Medi Info ì˜ Smart Nurse ENR ì‹œìŠ¤í…œì— ì €ì¥ëœ ìì—°ì–´ ê°„í˜¸ê¸°ë¡ ë°ì´í„°
- ë°ì´í„°ì˜ ìˆ˜ : *18,400+ (NCP + AWS DB)*
    - NANDA : *1,900+*
        
        ![ìŠ¤í¬ë¦°ìƒ· 2023-11-30 210912.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-11-30_210912.png)
        
    - SOAPIE : *900+*
        
        ![ìŠ¤í¬ë¦°ìƒ· 2023-11-30 211048.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-11-30_211048.png)
        
    - Focus_DAR : *2,200+*
        
        ![ìŠ¤í¬ë¦°ìƒ· 2023-11-30 211151.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-11-30_211151.png)
        
    - Narrative Note : *13,000+*
        
        ![ìŠ¤í¬ë¦°ìƒ· 2023-11-30 211333.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-11-30_211333.png)
        
    - Nursing Data: *400+*
        
        ![ìŠ¤í¬ë¦°ìƒ· 2023-11-30 211421.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-11-30_211421.png)
        

![data.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/data.png)

<aside>
ğŸ’¡ NaN, íŠ¹ìˆ˜ë¬¸ì, ìˆ«ì, í•œê¸€ ììŒ, ì•ŒíŒŒë²³, ë…¸ë˜ê°€ì‚¬, ì–´ìƒ‰í•œ ë¬¸ì¥ ë“± ì˜ëª» ì‘ì„±ëœ raw ë°ì´í„° í™•ì¸

</aside>

---

### b. 1ì°¨ ì „ì²˜ë¦¬

- raw data ì§ì ‘ ê²€ìˆ˜
- ì •ê·œí‘œí˜„ì‹ ì½”ë“œ ì‘ì„±
    - ì½”ë“œ
        
        ```python
        # í•„í„°ë§ ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” í–‰ì„ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        def is_valid_row(text):
            # ìˆ«ìë§Œ / ì•ŒíŒŒë²³ë§Œ / í•œê¸€ìëª¨ìŒë§Œ / íŠ¹ìˆ˜ ë¬¸ìë§Œ ìˆëŠ” ê²½ìš°
            if re.fullmatch(r'\d+', text) or re.fullmatch(r'[a-zA-Z]+', text) or re.fullmatch(r'[ã„±-ã…ã…-ã…£]+', text) or re.fullmatch(r'[^\w\s]+', text):
                return False
            return True
        
        # í•„í„°ë§ ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” ë‹¨ì–´ë¥¼ ì œê±°í•˜ëŠ” í•¨ìˆ˜
        def remove_invalid_words(text)
            words = str(text).split()
            valid_words = [word for word in words if is_valid_row(word)]
            return ' '.join(valid_words) if valid_words else pd.NA  # ë¹ˆ ë¬¸ìì—´ ëŒ€ì‹  pd.NA ë°˜í™˜
        
        # ê¸¸ì´ê°€ n ë¯¸ë§Œì¸ ë°ì´í„°ê°€ ìˆëŠ” í–‰ ì œê±°
        def remove_short_words(text):
            # ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ê³  ë‹¨ì–´ë¡œ ë¶„ë¦¬
            words = str(text).split()
            # ê¸¸ì´ê°€ 3 ì´ˆê³¼ì¸ ë‹¨ì–´ë§Œ ìœ íš¨í•˜ë‹¤ê³  íŒë‹¨
            valid_words = [word for word in words if len(word) > 3]
            # ìœ íš¨í•œ ë‹¨ì–´ë“¤ì„ ë‹¤ì‹œ ë¬¸ìì—´ë¡œ í•©ì¹˜ê¸°
            return ' '.join(valid_words) if valid_words else pd.NA
        
        # ë™ìŒì´ì˜ì–´ ì œê±°
        def unify_terms(sentence):
            S_patterns_to_unify = [
                r'<ì£¼ê´€ì (?![\]ìë£Œ])',
                r'\[ì£¼ê´€ì \]',
                r'ì£¼ê´€ì :',
                r'-ì£¼ê´€ì :',
                r'ì£¼ê´€ì ìë£Œ:',
                r'\[ì£¼ê´€ì ìë£Œ\]',
                r'ì£¼ê´€ì ìë£Œ(?!\])',
                r'\<ì£¼ê´€ì ìë£Œ\>',
                r'\[ì£¼ê´€ì ',
                r'\*ì£¼ê´€ì ',
                r'\(ì£¼ê´€ì \)',
                r'\(ì£¼ê´€ì ',
                r'ì£¼ê´€ì -ë³´í˜¸ì',
                r'\(\[ì£¼ê´€ì ìë£Œ\]\)',
                r'-\[ì£¼ê´€ì ìë£Œ\]',
                r'\*\[ì£¼ê´€ì ìë£Œ\]',
            ]
        
            O_patterns_to_unify = [
                r'<ê°ê´€ì (?![\]ìë£Œ])',
                r'\[ê°ê´€ì \]',
                r'ê°ê´€ì :',
                r'-ê°ê´€ì :',
                r'ê°ê´€ì ìë£Œ:',
                r'\[ê°ê´€ì ìë£Œ\]',
                r'ê°ê´€ì ìë£Œ(?!\])',
                r'\<ê°ê´€ì ìë£Œ\>',
                r'\[ê°ê´€ì ',
                r'\*ê°ê´€ì ',
                r'\(ê°ê´€ì \)',
                r'\(ê°ê´€ì ',
                r'ê°ê´€ì -ë³´í˜¸ì',
                r'\(\[ê°ê´€ì ìë£Œ\]\)',
                r'-\[ê°ê´€ì ìë£Œ\]',
                r'\*\[ê°ê´€ì ìë£Œ\]',
            ]
            ST_patterns_to_unitfy = [
                r'ë‹¨ê¸°ëª©í‘œ:',
                r'\<ë‹¨ê¸°ëª©í‘œ\>',
                r'ë‹¨ê¸°ëª©í‘œ',
                r'-ë‹¨ê¸°ëª©í‘œ',
                r'ë‹¨ê¸°',
                r'ë‹¨ê¸°:',
                r'\[ë‹¨ê¸°\]',
                r'\<ë‹¨ê¸°\>',
                r'\*ë‹¨ê¸°ëª©í‘œ:',
                r'\*\[ë‹¨ê¸°ëª©í‘œ\]',
                r'\*ë‹¨ê¸°:',
                r'\*\<ë‹¨ê¸°ëª©í‘œ\>',
                r'\*ë‹¨ê¸°ëª©í‘œ',
                r'\[ë‹¨ê¸°ëª©í‘œ\]\)',
                r'\(\[ë‹¨ê¸°ëª©í‘œ\]\)'
            ]
            LT_patterns_to_unitfy = [
                r'ì¥ê¸°ëª©í‘œ:',
                r'\<ì¥ê¸°ëª©í‘œ\>',
                r'ì¥ê¸°ëª©í‘œ',
                r'-ì¥ê¸°ëª©í‘œ',
                r'ì¥ê¸°',
                r'ì¥ê¸°:',
                r'\[ì¥ê¸°\]',
                r'\<ì¥ê¸°\>',
                r'\*ì¥ê¸°ëª©í‘œ:',
                r'\*\[ì¥ê¸°ëª©í‘œ\]',
                r'\*ì¥ê¸°:',
                r'\*\<ì¥ê¸°ëª©í‘œ\>',
                r'\*ì¥ê¸°ëª©í‘œ',
                r'\[ì¥ê¸°ëª©í‘œ\]\)',
                r'\(\[ì¥ê¸°ëª©í‘œ\]\)'
        
            ]
        
            for pattern in S_patterns_to_unify:
              sentence = re.sub(pattern, '[ì£¼ê´€ì ìë£Œ]', sentence)
        
            for pattern in O_patterns_to_unify:
              sentence = re.sub(pattern, '[ê°ê´€ì ìë£Œ]', sentence)
        
            for pattern in ST_patterns_to_unitfy:
              sentence = re.sub(pattern, '[ë‹¨ê¸°ëª©í‘œ]', sentence)
        
            for pattern in LT_patterns_to_unitfy:
              sentence = re.sub(pattern, '[ì¥ê¸°ëª©í‘œ]', sentence)
        
            # '[ì£¼ê´€ì ìë£Œ]ìë£Œ]'ì™€ ê°™ì€ íŒ¨í„´ì„ '[ì£¼ê´€ì ìë£Œ]'ë¡œ ì¹˜í™˜
            sentence = re.sub(r'\[ì£¼ê´€ì ìë£Œ\](ìë£Œ\])+', '[ì£¼ê´€ì ìë£Œ]', sentence)
            sentence = re.sub(r'\[ê°ê´€ì ìë£Œ\](ìë£Œ\])+', '[ê°ê´€ì ìë£Œ]', sentence)
            sentence = re.sub(r'\[\[\[ë‹¨ê¸°ëª©í‘œ\]ëª©í‘œ\]\]', '[ë‹¨ê¸°ëª©í‘œ]', sentence)
            sentence = re.sub(r'\[\[ë‹¨ê¸°ëª©í‘œ\]ëª©í‘œ\]', '[ë‹¨ê¸°ëª©í‘œ]', sentence)
            sentence = re.sub(r'\[ë‹¨ê¸°ëª©í‘œ\]:', '[ë‹¨ê¸°ëª©í‘œ]', sentence)
            sentence = re.sub(r'\[\[\[ì¥ê¸°ëª©í‘œ\]ëª©í‘œ\]\]', '[ì¥ê¸°ëª©í‘œ]', sentence)
            sentence = re.sub(r'\[\[ì¥ê¸°ëª©í‘œ\]ëª©í‘œ\]', '[ì¥ê¸°ëª©í‘œ]', sentence)
            sentence = re.sub(r'\[ì¥ê¸°ëª©í‘œ\]:', '[ì¥ê¸°ëª©í‘œ]', sentence)
            return sentence
        
        # ì¤‘ë³µ í–‰ ì œê±°
        def check_row_for_duplicates(row):
            row_values = row.tolist()
            return len(row_values) != len(set(row_values))
        
        # ìœ„ ì „ì²˜ë¦¬ í•¨ìˆ˜ë“¤ì„ ì ìš©í•˜ëŠ” í•¨ìˆ˜
        def function_apply(df, filter_column) :
            # ëª¨ë“  ì—´ì— ì ìš©
            for column in df.columns :
                df[column] = df[column].apply(remove_invalid_words)
        
            # filterëœ ì—´ì—ë§Œ ì ìš©
            for column in filter_column :
                df[column] = df[column].apply(remove_short_words)
        
            # í–‰ë³„ë¡œ ì ìš©
            df = df[~df.apply(check_row_for_duplicates, axis = 1)]
        
            # '<NA>'ê°€ í¬í•¨ëœ í–‰ ì œê±°
            df = df[~df.apply(lambda x: x.astype(str).str.contains('<NA>')).any(axis=1)]
            df = df.reset_index(drop=True)
        
            # ëª¨ë“  í–‰ ë™ìŒì´ì˜ì–´ ì²˜ë¦¬
            for column in df.columns:
              df[column] = df[column].apply(unify_terms)
        
            return df
        ```
        
    - ì „ê³¼ í›„ ë¹„êµ
        
        ![**ì „ì²˜ë¦¬(ì „)**](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-11-30_213115.png)
        
        **ì „ì²˜ë¦¬(ì „)**
        
        ![ìŠ¤í¬ë¦°ìƒ· 2023-11-30 213046.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-11-30_213046.png)
        
        ì „ì²˜ë¦¬(í›„)
        
    

**ì´ìŠˆ ë° í•œê³„ì **

- ë¶ˆìš©ì–´ ì²˜ë¦¬ ì½”ë“œë¡œ ì¸í•´ ì˜ë¯¸ìˆëŠ” ë‹¨ì–´ë„ ì‚­ì œë˜ëŠ” ê²½ìš° ë°œìƒ
- ë„ë©”ì¸ì— íŠ¹í™”ëœ ìì—°ì–´ ë°ì´í„° ì²˜ë¦¬ì˜ ì–´ë ¤ì›€ â†’ ìœ ì˜ë¯¸í•œ ì •ë³´ì™€ ë¬´ì˜ë¯¸í•œ ì •ë³´ì˜ êµ¬ë¶„ ë° ì·¨ì‚¬ì„ íƒ
- ë°ì´í„° ì „ì²˜ë¦¬ë¥¼ ê¼¼ê¼¼í•˜ê²Œ í• ìˆ˜ë¡ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì˜ ìˆ˜ê°€ ì¤„ì–´ë“¬ â†’ í•™ìŠµì´ ì˜ ë˜ì§€ ì•Šì„ ê°€ëŠ¥ì„±
- ì‹¤ìŠµìš©(êµìœ¡ìš©) ë°ì´í„°ì˜ í•œê³„ â†’ ì˜ë£Œì—…ê³„ëŠ” ì •í™•í•œ ë°ì´í„°ê°€ ì¤‘ìš”í•œë° ê·¸ë ‡ì§€ ëª»í•œ ê²½ìš°ê°€ ë§ì•˜ìŒ
- ë°ì´í„° ì „ì²˜ë¦¬ì— ë§ì€ ì‹œê°„ ì†Œìš” â†’ ê·¸ëŸ¬ë‚˜ **ë°ì´í„°ì „ì²˜ë¦¬ëŠ” í•œê¸€ ìì—°ì–´ì²˜ë¦¬ ê³¼ì œì˜ í•µì‹¬**

### c. 2ì°¨ ì „ì²˜ë¦¬

- í•™ìŠµ ë°ì´í„°ì…‹ì—ì„œ ì´ 17ê°œì˜ ë¹ˆì¶œ ë³‘ëª… ì¶”ì¶œ
    - `ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ / ë¹„íš¨ê³¼ì  ê¸°ë„ì²­ê²° / ê°€ìŠ¤êµí™˜ ì¥ì•  / ë‚™ìƒì˜ ìœ„í—˜ / ë¶ˆì•ˆì •í•œ í˜ˆì••ì˜ ìœ„í—˜ / ê·¼ìœ¡ì˜ ê¸´ì¥ / ì¶©ìˆ˜ì—¼ìœ¼ë¡œ ì¸í•œ ë³µí†µ / ì™¸ìƒì„± ì§€ì£¼ë§‰í•˜ ì¶œí˜ˆ / ë‹¹ë‡¨ë³‘ / ë¬´ë¦ê´€ì ˆì¦ / í‡´í–‰ì„± ê´€ì ˆì—¼ / í†µì¦ / ìš•ì°½ / ìë°œì  í™˜ê¸°ì¥ì•  / ê¸‰ì„±í†µì¦ / ê³ ì²´ì˜¨ / ë¶„ë§Œ í†µì¦`
        
        ![ìŠ¤í¬ë¦°ìƒ· 2023-11-30 224302.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2023-11-30_224302.png)
        
    - ì¶”ì¶œí•œ ë³‘ëª… í‚¤ì›Œë“œ ë³„ë¡œ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ì—¬ êµ¬ì²´ì ìœ¼ë¡œ ì „ì²˜ë¦¬
        - Langchain GPT prompting ì„ í™œìš©í•˜ì—¬ ì–‘ì‹ë³„ ë°ì´í„° ì „ì²˜ë¦¬(ë§ì¶¤ë²• ë“±)
        - ì½”ë“œ
            
            ```python
            import pandas as pd
            from langchain.chat_models import AzureChatOpenAI
            from langchain.prompts import ChatPromptTemplate
            
            # Azure OpenAIë¥¼ ì‚¬ìš©í•˜ëŠ” ê°ì²´ ìƒì„±
            chat = AzureChatOpenAI(
                deployment_name='ëª¨ë¸',
                model_name='gpt-35-turbo',
            )
            
            # í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ìƒì„±
            prompt = ChatPromptTemplate.from_messages(
                [
                    (
                        "system",
                        
                        """ ë‹¹ì‹ ì€ ê°„í˜¸ê¸°ë¡ ì‘ì„±ì§€ë¥¼ ì‘ì„±í•´ì£¼ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ë‹¤ìŒì˜ ì˜ë£Œê¸°ë¡ì„ ë¶„ì„í•˜ê³  ì¤‘ê°„ì— ëŠê¸´ ë¬¸ì¥ì´ ìˆê±°ë‚˜ ì˜¤íƒˆìê°€ ìˆìœ¼ë©´ ì•Œë§ê²Œ ìˆ˜ì •í•˜ê³  NANDA í˜•ì‹ìœ¼ë¡œ ì¶œë ¥í•˜ì„¸ìš”.
                        í•œê¸€ë¡œ ì‘ì„±í•˜ì„¸ìš”.
                        """,
                    ),
                    ("human", "{medical_record}"),
                ]
            )
            
            # í”„ë¡¬í”„íŠ¸ì™€ ì±„íŒ… ëª¨ë¸ ê²°í•©
            chain = prompt | chat  
            
            # CSV íŒŒì¼ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
            pd.read_csv("ê° ì „ì²˜ë¦¬í•œ íŒŒì¼ ê²½ë¡œ")
            
            # ìƒˆë¡œìš´ ë°ì´í„°ì…‹
            new_dataset = []
            
            # ê° í–‰ ì²˜ë¦¬
            for index, row in df.iterrows():
                response = chain.invoke({"medical_record": row['input']})
                new_dataset.append({'input': row['input'], 'output': response})
                print(response)
                
            
            # ìƒˆë¡œìš´ ë°ì´í„°ì…‹ì„ DataFrameìœ¼ë¡œ ë³€í™˜
            new_df = pd.DataFrame(new_dataset)
            
            # ìƒˆë¡œìš´ ë°ì´í„°ì…‹ì„ CSV íŒŒì¼ë¡œ ì €ì¥
            new_df.to_csv("ì €ì¥í•˜ê³  ì‹¶ì€ ê²½ë¡œ\\ì´ë¦„.csv", index=False, encoding='utf-8')
            ```
            
        - ì˜ˆì‹œ
            
            ![preprocess.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/preprocess.png)
            

### d. LLM í•™ìŠµ ë°ì´í„°ì…‹ ì œì‘

- ì „ì²˜ë¦¬í•œ ë°ì´í„°ì…‹ì„ LLM í•™ìŠµì— í•„ìš”í•œ jsonl í˜•íƒœë¡œ ë³€í™˜
    - ê°„í˜¸ê¸°ë¡ ë°ì´í„° ì»¬ëŸ¼ì—ì„œ ë³‘ëª…(disease name) ì¶”ì¶œ
        - ë³‘ëª…ì„ ì¶”ì¶œ í•  ìˆ˜ ì—†ëŠ” ë°ì´í„°ëŠ” ì œê±°
    - ì½”ë“œ
        
        ```python
        import pandas as pd
        from langchain.chat_models import ChatOpenAI
        from langchain.chat_models import AzureChatOpenAI
        from langchain.prompts import ChatPromptTemplate
        
        # Azure OpenAIë¥¼ ì‚¬ìš©í•˜ëŠ” ê°ì²´ ìƒì„±
        chat = AzureChatOpenAI(
            deployment_name='ëª¨ë¸',
            model_name='gpt-35-turbo',
        )
        
        # ë³‘ëª… ì¶”ì¶œ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ìƒì„±
        prompt = ChatPromptTemplate.from_messages(
            [
                (
                    "system",
                    
                    """ ë‹¹ì‹ ì€ ê°„í˜¸ê¸°ë¡ ì‘ì„±ì§€ë¥¼ ì‘ì„±í•´ì£¼ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ë‹¤ìŒì˜ ì˜ë£Œê¸°ë¡ì„ ë¶„ì„í•˜ê³  ì˜ˆì‹œë¥¼ ì°¸ê³ í•˜ì—¬ ëŒ€í‘œì ì¸ ë³‘ëª… í•˜ë‚˜ë§Œ ê¸°ì…í•˜ì„¸ìš”.
                    ì˜ˆì‹œ : ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ, ë¹„íš¨ê³¼ì  ê¸°ë„ì²­ê²°, ê°€ìŠ¤êµí™˜ ì¥ì• , ë‚™ìƒì˜ ìœ„í—˜, ë¶ˆì•ˆì •í•œ í˜ˆì••ì˜ ìœ„í—˜, ê·¼ìœ¡ì˜ ê¸´ì¥,  ì¶©ìˆ˜ì—¼ìœ¼ë¡œ ì¸í•œ ë³µí†µ,  ì™¸ìƒì„± ì§€ì£¼ë§‰í•˜, ì¶œí˜ˆ,  ë‹¹ë‡¨ë³‘,  ë¬´ë¦ê´€ì ˆì¦ í‡´í–‰ì„± ê´€ì ˆì—¼,  í†µì¦,  ìš•ì°½,  ìë°œì  í™˜ê¸°ì¥ì• ,  ê¸‰ì„±í†µì¦,  ê³ ì²´ì˜¨,  ë¶„ë§Œ í†µì¦ 
                    """,
                ),
                ("human", "{medical_record}"),
            ]
        )
        
        # í”„ë¡¬í”„íŠ¸ì™€ ì±„íŒ… ëª¨ë¸ ê²°í•©
        chain = prompt | chat  
        # CSV íŒŒì¼ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        pd.read_csv("ë¬¸ì¥ ìˆ˜ì •í•œ íŒŒì¼ ê²½ë¡œ", encoding="utf-8")
        # ìƒˆë¡œìš´ ë°ì´í„°ì…‹
        new_dataset = []
        
        # ê° í–‰ ì²˜ë¦¬
        for index, row in df.iterrows():
            response = chain.invoke({"medical_record": row['input']})
            new_dataset.append({'input': row['input'], 'disease name': response})
            print(response)
            
        
        # ìƒˆë¡œìš´ ë°ì´í„°ì…‹ì„ DataFrameìœ¼ë¡œ ë³€í™˜
        new_df = pd.DataFrame(new_dataset)
        
        # ì •ì œ í•¨ìˆ˜ì •ì˜
        def cleaning(text):
            replacements = {
                r'content=': '',
                r'.*ë³‘ëª…': 'ë³‘ëª…',
                r'ë³‘ëª… : ' : 'ë³‘ëª…: ',
                r'A:' : 'ë³‘ëª…:',
                r'ì£¼ì§„ë‹¨ëª…': 'ë³‘ëª…',
                r'ì§„ë‹¨ëª…' : 'ë³‘ëª…',
        
            }
        
            for pattern, replacement in replacements.items():
                text = re.sub(pattern, replacement, text)
        
            return text
        
        def clean2(text):
          text = re.sub(r'ë³‘ëª…: ', '', text)
          return text
        
        # ë°ì´í„°í”„ë ˆì„ì— í•¨ìˆ˜ ì ìš©
        new_df['disease name'] = new_df['disease name'].apply(cleaning)
        new_df
        
        # ìƒˆë¡œìš´ ë°ì´í„°ì…‹ì„ CSV íŒŒì¼ë¡œ ì €ì¥
        new_df.to_csv("ì €ì¥í•˜ê³  ì‹¶ì€ ê²½ë¡œ\\ì´ë¦„.csv", index=False, encoding='utf-8')
        ```
        
    - ê²°ê³¼
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-12-14 á„‹á…©á„’á…® 2.16.34.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-12-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.16.34.png)
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-12-14 á„‹á…©á„’á…® 2.31.28.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-12-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.31.28.png)
        
    - jsonl í˜•íƒœë¡œ ë³€í™˜
    - ì˜ˆì‹œ
        
        ```json
        
        {"role": "user", "content": "**í˜¸í¡ê³¤ë€**ì— ëŒ€í•œ ê°„í˜¸ê¸°ë¡ì„ FOCUS DARí˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜"}, {"role": "assistant", "content": "FOCUS:  ë¹„ê°•ìºë‰¼ë¼ë¥¼ í†µí•œ ì‚°ì†Œìš”ë²• D: [ì£¼ê´€ì  ìë£Œ] \"ìˆ¨ì‰¬ê¸°ê°€ ë‹µë‹µí•´ìš”.\"    [ê°ê´€ì  ìë£Œ] í˜¸í¡ê³¤ë€ê³¼ ì „ì‹ ì‡ ì•½ ì¦ìƒìœ¼ë¡œ ì¸í•´ ìˆœí™˜ê¸°ë‚´ê³¼ ì…ì›ì¹˜ë£Œë¥¼ ìš”ì²­í•¨. ì•ˆì ˆë¶€ì ˆ ë§ì´ˆì‚°ì†Œí¬í™”ë„ ì¸¡ì • ê²°ê³¼ Sp02. A: - ì£¼ì¹˜ì˜ê°€ cannulaë¡œ 3L/min ë§ì´ˆì‚°ì†Œí¬í™”ë„ ì¸¡ì • ê²°ê³¼ë¥¼ ê³„ì†í•´ì„œ ëª¨ë‹ˆí„°ë§í•˜ë©°, í˜¸í¡ê³¤ë€ìœ¼ë¡œ Semi-Fowler\\'s positionì„ ì ìš©í•˜ì—¬ ëŒ€ìƒìì˜ ì „ë°˜ì ì¸ ìƒíƒœë¥¼ í™•ì¸í•¨.    - ëŒ€ìƒìì˜ í™œë ¥ì§•í›„ ë° í˜¸í¡ìˆ˜ì™€ ì‚°ì†Œ ì‚¬ìš©ëŸ‰ìœ¼ë¡œ í™”ì¬ ë°œìƒ ìœ„í—˜ì„±ì´ ìˆì–´ ë¹„ê°•ìºë‰¼ë¼ë¥¼ í†µí•œ ì‚°ì†Œìš”ë²•ì„ ì‹œí–‰í•˜ê³ , í”¼ë¶€ ì†ìƒì˜ ìœ„í—˜ì„±ì— ëŒ€í•´ ìœ ì˜í•¨. R: í˜ˆì•• 100/70mmHg, ë§¥ë°• 90íšŒ/ë¶„, í˜¸í¡ìˆ˜ 20íšŒ/ë¶„, ì²´ì˜¨ 37.0ËšC, Sp02 ì¸¡ì • ê²°ê³¼ í˜¸í¡ê³¤ë€ì´ ì™„í™”ë˜ì—ˆìœ¼ë©°, ëŒ€ìƒìê°€ êµìœ¡ ë‚´ìš©ì„ ì´í•´í•˜ê³  í¸ì•ˆí•˜ë‹¤ê³  í•¨."}]}
        {"role": "user", "content": "**ìœ„ì¥ê´€ ì”ë¥˜ì¦**ì— ëŒ€í•œ ê°„í˜¸ê¸°ë¡ì„ NarrativeNoteí˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜"}, {"role": "assistant", "content": "NarrativeNote: ëŒ€ìƒìì˜ ìœ„ê´€ì˜ì–‘ì„ í™•ì¸í•œ ê²°ê³¼ 23mLì˜ ì”ë¥˜ëŸ‰ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•´ 1200ccì˜ ì•¡ì²´ë¥¼ L-Tube ë°©ë²•ì„ í†µí•´ ì£¼ì…í•˜ì˜€ìœ¼ë©°, gtt/minì„ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤. ëŒ€ìƒìëŠ” ë³µë¶€íŒ½ë§Œ ì¦ìƒì´ ì—†ì—ˆê³ , ë°˜ì¢Œìœ„ë¥¼ ì·¨í•˜ë„ë¡ êµìœ¡í•˜ì˜€ìŠµë‹ˆë‹¤."}]}
        {"role": "user", "content": "**ìƒì„¸ë¶ˆëª…ì˜ ë°”ì´ëŸ¬ìŠ¤ì— ì˜í•œ ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ**ì— ëŒ€í•œ ê°„í˜¸ê¸°ë¡ì„ NANDA DARí˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜"}, {"role": "assistant", "content": "Domain: í™œë™/íœ´ì‹  [Class] ì‹¬í˜ˆê´€/í˜¸í¡ê¸°ê³„ ë°˜ì‘  [Diagnosis] ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ  [Collecting Data] í™˜ìëŠ” \"ìˆ¨ì‰¬ê¸°ê°€ ë¶ˆí¸í•´ìš”\" ë¼ê³  ì–¸ê¸‰í•˜ì˜€ìœ¼ë©°, ì§„ë‹¨ëª…ì€ ìƒì„¸ë¶ˆëª…ì˜ ë°”ì´ëŸ¬ìŠ¤ì´ê³ , x-ray ê²°ê³¼ëŠ” rightì´ë©° 110/70 RR25 Spo2 ìŒ•ìƒ‰ê±°ë¦¬ëŠ” \"sutum\"ì´ ë°œê²¬ë˜ì—ˆë‹¤.  [Goal] - ë‹¨ê¸°ëª©í‘œ: ëŒ€ìƒìëŠ” ì •ìƒì ì¸ í˜¸í¡ì–‘ìƒì„ ê°€ì§€ê²Œ ëœë‹¤. - ì¥ê¸°ëª©í‘œ: ëŒ€ìƒìëŠ” í˜¸í¡í•˜ê¸° í¸ì•ˆí•˜ê²Œ ëœë‹¤.  [Plan] - í˜¸í¡ìˆ˜ì™€ ë¦¬ë“¬ì„ ì¸¡ì •í•˜ê³ , í•„ìš”ì‹œ ì¡°ì •í•œë‹¤. - íš¨ìœ¨ì ì¸ ê¸°ì¹¨ì„ í•˜ë„ë¡ ëŒ€ìƒìë¥¼ ê²©ë ¤í•œë‹¤. - ëŒ€ìƒìë¥¼ ì¿ ì…˜ìœ¼ë¡œ ì§€ì§€í•˜ì—¬ í˜¸í¡ê¸°ê³„ ì‚¬ìš©ì´ í•„ìš”í•˜ë‹¤ë©´ ì‚¬ìš©í•œë‹¤.  [Interventions] - í˜¸í¡ìˆ˜ì™€ ë¦¬ë“¬ì„ ì¸¡ì •í•˜ì˜€ê³ , 11/15 09:00ì— ë³€ê²½í•˜ì˜€ë‹¤. - í™˜ìë¶„ê»˜ì„œ í˜¸í¡ê¸° ê´€ë¦¬ë¥¼ ìœ„í•´ ë³€ê²½í•´ì£¼ì—ˆë‹¤. - ëŒ€ìƒìê°€ íš¨ìœ¨ì ìœ¼ë¡œ ê¸°ì¹¨í•  ìˆ˜ ìˆë„ë¡ ê²©ë ¤í•˜ì˜€ë‹¤. - ëŒ€ìƒìë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê²©ë ¤í•˜ì—¬ ë°°ì¶œì´ ì›í™œí•˜ë„ë¡ ë„ì™”ë‹¤. - ëŒ€ìƒìë¥¼ ì¿ ì…˜ìœ¼ë¡œ ì§€ì§€í•˜ì—¬ í˜¸í¡ê¸°ê³„ ì‚¬ìš©ì´ í•„ìš”í•˜ë‹¤ë©´ ì‚¬ìš©í•˜ì˜€ë‹¤.  [Evaluation] - ë‹¨ê¸°ëª©í‘œ: ëŒ€ìƒìëŠ” ì •ìƒì ì¸ í˜¸í¡ì–‘ìƒì„ (ë¯¸ë‹¬ì„±) 11/16 09:00 í™˜ìë¶„ê»˜ì„œ ì „ë³´ë‹¤ëŠ” ë‚˜ì•„ì¡Œì§€ë§Œ ë¶ˆí¸í•¨ì„ í˜¸ì†Œí•˜ì˜€ë‹¤. - ì¥ê¸°ëª©í‘œ: ëŒ€ìƒìëŠ” í˜¸í¡í•˜ê¸° í¸ì•ˆí•˜ë‹¤ê³  íŒë‹¨í•  ìˆ˜ ì—†ìœ¼ë©°, ì¶”í›„ ê´€ì°°ì´ í•„ìš”í•˜ë‹¤. (2022.11.15)"}]}
        {"role": "user", "content": "**ì§€ì£¼ë§‰í•˜ ì¶œí˜ˆ**ì— ëŒ€í•œ ê°„í˜¸ê¸°ë¡ì„ SOAPIEí˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜"}, {"role": "assistant", "content": "S: \"í™˜ìê°€ ë¨¹ì„ ë•Œë§ˆë‹¤ ê±¸ë ¤ìš”\" O: ì§€ì£¼ë§‰í•˜ ì¶œí˜ˆ ì§„ë‹¨ìœ¼ë¡œ ì…ì›í•˜ì—¬ ì¹˜ë£Œ ì¤‘ì´ë©° ê¸°ì¹¨ì´ ê´€ì°°ë©ë‹ˆë‹¤. A: -ì—°í•˜ê³¤ë€ìœ¼ë¡œ êµ¬ê°•ì„­ì·¨ ì–´ë ¤ì›€ì´ ìˆìŒ. P: semi-fowlerì˜ ìì„¸ë¡œ ì·¨ì¹¨ ì‹œí‚¤ê¸°, í•„ìš”ì‹œ ê²½ì¥ ì˜ì–‘ì•¡ ì œê³µ ë° í¡ì¸ ì‹œ íˆ¬ì—¬í•˜ê¸°. I: -ê²½ì¥ ì˜ì–‘ì•¡ ìˆ˜í–‰í•¨. -ê²½ì¥ ì˜ì–‘ íˆ¬ì—¬ë¥¼ ìœ„í•´ í¡ì¸í•˜ì—¬ í™•ì¸í•¨. -L-tube ì‚½ì…í•˜ì—¬ 200ml ì£¼ì…í•¨. 30mlì”© ì£¼ì…í•¨. ì¸¡ì •í•¨. -ì•‰ì•„ìˆì„ ë•Œì˜ êµìœ¡ì„ ì‹œí–‰í•¨. E: -L-tube ì‚½ì… í›„ semi-fowlerì˜ ìì„¸ë¥¼ ìœ ì§€í•¨."}]}
        ```
        
- ìµœì¢…ì ìœ¼ë¡œ í•™ìŠµì— ì‚¬ìš©í•œ ë°ì´í„°
    
    ![train_data.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/train_data.png)
    

# 3. Model : LLM(GPT-3.5 Turbo) Fine Tuning

### a. GPT API : Microsoft Azure Open AI

- GPT API ë¶ˆëŸ¬ì˜¤ê¸° ì½”ë“œ
    
    ```python
    !pip install openai
    from openai import OpenAI
    
    #api ë¶ˆëŸ¬ì˜¤ê¸°
    client = OpenAI(api_key=" ")
    prompt = [{"role": "system", "content": "system"}]
    
    def chat(text):
      user_input = {"role": "user", "content": text}
      prompt.append(user_input)
      answer = client.chat.completions.create(
          model="gpt-3.5-turbo",
          prompt=prompt,
          temperature=1,
          top_p=0.9) # ë‹¤ë¥¸ parameter ì¶”ê°€
    
      answ = answer.to_dict_recursive()
      bot_answ = answer['choices'][0]['meassage']['content']
      bot_resp = {"role" : "assistant", "content" : bot_answ}
      prompt.append(bot_resp)
      return bot_answ
    
    print(chat("ë‚™ìƒ ê³ ìœ„í—˜êµ° ê°„í˜¸ê¸°ë¡ ì¨ì¤˜."))
    ```
    
    â†’ ê¸°ì—…ì—ì„œ ì œê³µí•œ Azureë¥¼ í†µí•´ì„œ OpenAI APIë¥¼ ì‚¬ìš©í•  ì˜ˆì •
    

### b. GPT Fine-tuning

- ë¹ˆì¶œ ë³‘ëª…ë³„ ê° ì–‘ì‹ì˜ ì´ìƒì ì¸ ìƒ˜í”Œ ë°ì´í„°ì…‹ ì œì‘
    - ChatGPT í™œìš©
        
        ![generation.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/generation.png)
        
        - ChatGPTì— ëŒ€í•œ ì˜¤ë¥˜ ì²´í¬
        (e.g. í†µì¦í™˜ìì˜ ê°„í˜¸ê¸°ë¡ì„ ì‘ì„±í•˜ë¼ëŠ” instructì— â€˜í•˜í’ˆ í†µì¦ í™˜ìâ€™ ì˜ˆì‹œë¥¼ ìƒì„±)
    - ì˜ˆtl
- GPT Fine-tuning
    - Instruction tuning
        
        ```python
        system_instruction =
        """
        ë„ˆëŠ” ëŒ€í•™ë³‘ì› ê°„í˜¸ì‚¬ì•¼. ë‹¤ìŒì˜ ì§€ì¹¨ëŒ€ë¡œ ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ì„ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•´ì¤˜.
        
        1. NANDA, SOAPIE, Focus DAR ë“± ê°„í˜¸ê¸°ë¡ ì–‘ì‹ì— ë§ê²Œ ì ì–´ì£¼ì„¸ìš”.
        2. ì£¼ìš” ì¦ìƒ ë° íŠ¹ì„±, ë‹¨ê¸° ë° ì¥ê¸° ëª©í‘œ, ê°„í˜¸ ì¤‘ì¬, ê°„í˜¸ í‰ê°€ í•­ëª©ì„ í•„ìˆ˜ ê¸°ì¬í•˜ì„¸ìš”.
        3. ìµœëŒ€í•œ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ 'ì ì ˆí•œ í˜¸í¡ ê¸°ë²• êµìœ¡'ì´ë€ ë‹µë³€ ë³´ë‹¨ 'í˜¸í¡ ìš´ë™ êµìœ¡: ê¹Šê³  ì²œì²œíˆ ìˆ¨ì‰¬ê¸°, ë³µì‹í˜¸í¡ë²• êµìœ¡'ì´ ì¢‹ìŠµë‹ˆë‹¤.
        4. ì •í™•í•œ ìˆ˜ì¹˜ë¥¼ ê¸°ë¡í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ 'í™˜ìì˜ í˜¸í¡ìˆ˜ê°€ 24ì‹œê°„ ì´ë‚´ì— ë¶„ë‹¹ 12~20íšŒë¡œ ì •ìƒ ë²”ìœ„ ë‚´ë¡œ ê°ì†Œ'
        5. ì •í™•í•˜ê³  ê°„ê²°í•œ ë§íˆ¬ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. ~ì…ë‹ˆë‹¤. ~ì—ìš” ê°™ì€ ë¬¸ì¥ì‹ ì„œìˆ ì€ í”¼í•´ì£¼ì„¸ìš”.
        
        """
        ```
        
    - Prompt tuning
        
        ```python
        prompt_format = """"
        {"role": "system", "content": instruction"}, {"role": "user", "content": "Question"}, {"role": "assistant", "content": "Answer"}
        """
        prompt = [
            {"role": "system", "content": system_instruction}, {"role": "user", "content": "ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ NANDA ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."}, {"role": "assistant", "content": "í™˜ì ì •ë³´:\n\nì´ë¦„: ì´í•´ì¤€\në‚˜ì´: 34ì„¸\nì„±ë³„: ë‚¨ì„±\n\nì§„ë‹¨: ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ (NANDA-I #00032)\n\nì£¼ìš” ì¦ìƒ ë° íŠ¹ì„±:\n\n*í˜¸í¡ìˆ˜ ì¦ê°€ (ë¶„ë‹¹ 24íšŒ)\n*í˜¸í¡ê³¤ë€ ì¦ìƒ (ì–•ê³  ë¹ ë¥¸ í˜¸í¡)\n*ì‚°ì†Œí¬í™”ë„ ê°ì†Œ (92%)\n*í™˜ìì˜ ì£¼ê´€ì  í˜¸í¡ ë¶ˆí¸ í‘œí˜„\n\në‹¨ê¸° ëª©í‘œ:\n\n*í™˜ìì˜ í˜¸í¡ìˆ˜ê°€ 24ì‹œê°„ ì´ë‚´ì— ë¶„ë‹¹ 12~20íšŒë¡œ ì •ìƒ ë²”ìœ„ ë‚´ë¡œ ê°ì†Œ\n*ì‚°ì†Œí¬í™”ë„ê°€ 95% ì´ìƒìœ¼ë¡œ ìœ ì§€\n\nì¥ê¸° ëª©í‘œ:\n\n*í™˜ìê°€ í˜¸í¡ ê³¤ë€ì„ í˜¸ì†Œí•˜ì§€ ì•Šê³ , ì‚°ì†Œí¬í™”ë„ê°€ ì§€ì†ì ìœ¼ë¡œ 95% ì´ìƒ ìœ ì§€\n*í™˜ìê°€ í˜¸í¡ì— ê´€ë ¨ëœ ìê°€ ê´€ë¦¬ ë°©ë²•ì„ ì´í•´í•˜ê³  ì‹¤í–‰\n\nê°„í˜¸ ê³„íš ë° ì¤‘ì¬:\n\n*í˜¸í¡ ìƒíƒœ ëª¨ë‹ˆí„°ë§: 2ì‹œê°„ë§ˆë‹¤ í˜¸í¡ìˆ˜, ì‚°ì†Œí¬í™”ë„ ì²´í¬\n*ì‚°ì†Œ ìš”ë²•: ì˜ì‚¬ì˜ ì§€ì‹œì— ë”°ë¼ ì‚°ì†Œ ê³µê¸‰ (í•„ìš” ì‹œ)\n*í˜¸í¡ ìš´ë™ êµìœ¡: ê¹Šê³  ì²œì²œíˆ ìˆ¨ì‰¬ê¸°, ë³µì‹í˜¸í¡ë²• êµìœ¡\n*ì•ˆìœ„ ì œê³µ: í¸ì•ˆí•œ ìì„¸ ìœ ì§€, ìŠ¤íŠ¸ë ˆìŠ¤ ê°ì†Œ ë°©ë²• ì•ˆë‚´\n*êµìœ¡ ë° ìƒë‹´: í˜¸í¡ê³¤ë€ì˜ ì›ì¸ê³¼ ê´€ë¦¬ ë°©ë²• ì„¤ëª…\n\nê°„í˜¸ í‰ê°€:\n*í˜¸í¡ ìƒíƒœ: í˜¸í¡ìˆ˜ ë° ì‚°ì†Œí¬í™”ë„ ë³€í™” ëª¨ë‹ˆí„°ë§\n*í™˜ìì˜ ìê°€ ê´€ë¦¬ ëŠ¥ë ¥: í˜¸í¡ ìš´ë™ ì‹¤ì‹œ ì—¬ë¶€ ë° íš¨ê³¼ í‰ê°€\n*êµìœ¡ íš¨ê³¼: í™˜ìì˜ ì´í•´ë„ ë° ë°˜ì‘ ê´€ì°°"},
            {"role": "system", "content": system_instruction}, {"role": "user", "content": "ê³ ì²´ì˜¨ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ì„ SOAPIE ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."}, {"role": "assistant", "content":"í™˜ì ì •ë³´: \n ì´ë¦„: ì •ìˆ˜í˜„\n ë‚˜ì´: 32ì„¸\n ì„±ë³„: ì—¬ì„±\n\nSOAPIE ê¸°ë¡:\n\nS: ì£¼ê´€ì  ë°ì´í„° (Subjective):\n í™˜ìëŠ” ìµœê·¼ì— ì²´ì˜¨ì´ ê³„ì†í•´ì„œ ë†’ì•„ì§€ë©° "'ê³„ì† ë•€ì´ ë‚˜ê³  ëª¸ì´ ì‘¤ì…”'"ë¼ê³  ì–¸ê¸‰í•¨.\n\nO: ê°ê´€ì  ë°ì´í„° (Objective): \nì²´ì˜¨ì´ 38.8Â°Cë¡œ ìƒìŠ¹\ní”¼ë¶€ëŠ” ëœ¨ê±°ì›Œ ë³´ì´ê³  ë•€ì´ ë§ì´ ë‚˜ê³  ìˆìŒ. \nì‹ìš• ê°ì†Œ ë° ì²´ì¤‘ ê°ì†Œë„ ê´€ì°°ë¨.\n\nA: í‰ê°€ (Assessment): \ní™˜ìëŠ” ê³ ì²´ì˜¨ ìƒíƒœì— ìˆìŒ\nê³ ì²´ì˜¨ì´ ì‹ìš• ê°ì†Œì™€ ì²´ì¤‘ ê°ì†Œë¥¼ ìœ ë°œí•¨.\n\nP: ê³„íš (Plan):  \n1. ì ì ˆí•œ ìˆ˜ë¶„ ê³µê¸‰ê³¼ ëƒ‰ê°ì„ ìœ„í•œ ê°„í˜¸ ì¤‘ì¬   \n2. ì²´ì˜¨ ì¡°ì ˆì„ ìœ„í•œ ì˜ì‚¬ì™€ì˜ í˜‘ë ¥   \n3. ì˜ì–‘ ìƒíƒœ í‰ê°€ ë° ì˜ì–‘ì œ íˆ¬ì—¬ ê²€í† .\n\nI: ê°„í˜¸ ì¤‘ì¬ (Intervention): \n1. ì ì ˆí•œ ìˆ˜ë¶„ ê³µê¸‰ ë° ëƒ‰ê°ì„ ìœ„í•´ ì¿¨ë§ í…Œí¬ë‹‰ ì ìš©   \n2. ì˜ì‚¬ì˜ ì§€ì‹œì— ë”°ë¼ ì²´ì˜¨ ì¡°ì ˆì„ ìœ„í•œ ì¹˜ë£Œ ì‹œí–‰   \n3. ì˜ì–‘ì‚¬ì™€ í˜‘ë ¥í•˜ì—¬ í™˜ìì˜ ì˜ì–‘ ìƒíƒœë¥¼ í‰ê°€í•˜ê³  í•„ìš” ì‹œ ì˜ì–‘ì œ íˆ¬ì—¬.\n\nE: í‰ê°€ (Evaluation): \n1. ì¿¨ë§ í…Œí¬ë‹‰ê³¼ ìˆ˜ë¶„ ê³µê¸‰ìœ¼ë¡œ ì²´ì˜¨ì´ ì•ˆì •ë˜ê³  ë•€ì´ ê°ì†Œí•¨  \n 2. ì˜ì‚¬ì˜ ì¹˜ë£Œë¡œ ì²´ì˜¨ì´ ì •ìƒ ë²”ìœ„ë¡œ íšŒë³µë¨   \n3. ì˜ì–‘ ìƒíƒœê°€ í–¥ìƒë˜ê³  ì²´ì¤‘ì´ ì¦ê°€í•¨."},
            {"role": "system", "content": system_instruction}, {"role": "user", "content": "ë¶„ë§Œí†µì¦ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ì„ Focus DAR ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."}, {"role": "assistant", "content":"í™˜ì ì •ë³´:\nì´ë¦„: ê¹€ì§€ì€  \në‚˜ì´: 28ì„¸  \nì„±ë³„: ì—¬ì„±  \n\nFocus: ë¶„ë§Œ í†µì¦ ê´€ë¦¬  \n\nData:\n í™˜ìëŠ” í˜„ì¬ 38ì£¼ì— ì…ì„±í•œ ì„ì‹ ë¶€ë¡œ, ìì—°ë¶„ë§Œì„ í†µí•œ ë¶„ë§Œì„ ê³„íší•˜ê³  ìˆìŒ.\n í™˜ìëŠ” 1ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ìë°œì ìœ¼ë¡œ ì‹œì‘ëœ ìê¶ ìˆ˜ì¶•ì´ ì§„í–‰ ì¤‘ì´ë©°, ìˆ˜ì¶• ê°„ê²©ì´ ì ì°¨ ê°ì†Œí•˜ê³  ìˆìŒ.\n ë¶„ë§Œ ë„ì¤‘ì— í†µì¦ì´ ê°•í•˜ê²Œ ëŠê»´ì§€ë©°, ìê·¹ì„ ë°›ì„ ë•Œì™€ ìˆ˜ì¶• ì¤‘ì— ê°€ì¥ ê°•í•œ í†µì¦ì„ ëŠë¼ê³  ìˆìŒ.\n í†µì¦ì˜ ê°•ë„ëŠ” Visual Analog Scale (VAS)ë¡œ 8ì ìœ¼ë¡œ í‰ê°€ë˜ë©°, í†µì¦ê³¼ í•¨ê»˜ í˜¸í¡ ê³¤ë€ ë° ì•ˆì ˆë¶€ì ˆ ëª»í•˜ëŠ” ëŠë‚Œì„ í˜¸ì†Œí•¨.\n ì‚°ëª¨ëŠ” ìì—°ë¶„ë§Œì„ ì›í•˜ë©°, ì§„í†µì œì— ëŒ€í•œ ê°œì…ì„ ìµœì†Œí™”í•˜ê³ ì í•¨.\n\nAction:\n1. ê°„í˜¸ì§„ì€ ì‚°ëª¨ì˜ í†µì¦ ê²½í—˜ì„ ì •í™•íˆ ê¸°ë¡í•˜ê³ , ìì—°ë¶„ë§Œì„ ìœ„í•œ í†µì¦ ê´€ë¦¬ ê³„íš ìˆ˜ë¦½.\n2. í†µì¦ì˜ ê°•ë„ ë° ëŠë‚Œì„ ì •í™•íˆ ê¸°ë¡í•˜ê³ , ìˆ˜ì¶•ê³¼ í†µì¦ ê°„ì˜ ê´€ê³„ë¥¼ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ê´€ë¦¬ ì „ëµì„ ì°¾ìŒ.\n3. í˜¸í¡ ë° ì•ˆì •ì ì¸ ìì„¸ ìœ ì§€ì— ëŒ€í•œ êµìœ¡ì„ ì‹¤ì‹œí•˜ì—¬ ì‚°ëª¨ê°€ íš¨ê³¼ì ì¸ í†µì¦ ê´€ë¦¬ë¥¼ ìœ„í•´ ì ì ˆí•œ ë°©ë²•ì„ í™œìš©í•˜ë„ë¡ ì§€ì›.\n4. ì‚°ëª¨ì˜ í†µì¦ì— ëŒ€í•œ ì´í•´ë„ë¥¼ ë†’ì´ê³ , ì‚°ëª¨ì™€ ë™ë°˜ìì—ê²Œ í˜‘ë ¥ì ì¸ í†µì¦ ê´€ë¦¬ì— ëŒ€í•œ ì§€ì¹¨ì„ ì œê³µ.\n5. í•„ìš”í•œ ê²½ìš° ì˜ì‚¬ì™€ í˜‘ë ¥í•˜ì—¬ ì¶”ê°€ì ì¸ í†µì¦ ê´€ë¦¬ ì˜µì…˜ì„ ê²€í† í•˜ê³ , ë¶„ë§Œ ì§„í–‰ ìƒí™©ì— ë”°ë¼ ê´€ë¦¬ ê³„íšì„ ì¡°ì ˆ.\n\nResponse:\n ì‚°ëª¨ëŠ” í˜¸í¡ ë° ì•ˆì •ì ì¸ ìì„¸ ìœ ì§€ë¥¼ í†µí•´ í†µì¦ì„ ì¼ë¶€ ì™„í™”í•˜ê³ , ì ì ˆí•œ ë°©ë²•ì„ í™œìš©í•˜ì—¬ í†µì¦ì— ëŒ€ì²˜í•¨.\n í†µì¦ì˜ ê°•ë„ì™€ ëŠë‚Œì„ ì •í™•íˆ ê¸°ë¡í•˜ì—¬ ê°„í˜¸ì§„ì€ íš¨ê³¼ì ì¸ í†µì¦ ê´€ë¦¬ ê³„íšì„ ìˆ˜ë¦½í•˜ê³  ì¡°ì ˆí•¨.\n ì‚°ëª¨ëŠ” ì§„í†µì œì— ëŒ€í•œ ê°œì…ì„ ìµœì†Œí™”í•˜ê³ , ìì—°ë¶„ë§Œì˜ ê²½í—˜ì„ ì¤‘ìš”ì‹œí•˜ì—¬ í†µì¦ì„ ë”ìš± ê´€ë¦¬ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ ìœ ì§€í•¨.\n ê°„í˜¸ì§„ì˜ êµìœ¡ê³¼ ì§€ì›ì„ í†µí•´ ì‚°ëª¨ì™€ ë™ë°˜ìëŠ” í†µì¦ ê´€ë¦¬ì— ëŒ€í•œ ì´í•´ë„ê°€ í–¥ìƒë˜ì–´ í˜‘ë ¥ì ìœ¼ë¡œ ì°¸ì—¬í•¨.\n ë¶„ë§Œ ë„ì¤‘ì—ëŠ” ì‚°ëª¨ì˜ í†µì¦ ê´€ë¦¬ë¥¼ ê³„ì† ëª¨ë‹ˆí„°ë§í•˜ê³ , í•„ìš”ì— ë”°ë¼ ì˜ì‚¬ì™€ í˜‘ë ¥í•˜ì—¬ ì¶”ê°€ì ì¸ ì¡°ì¹˜ë¥¼ ì·¨í•¨."},
            {"role": "system", "content": system_instruction}, {"role": "user", "content": "ê°€ìŠ¤ êµí™˜ ì¥ì•  í™˜ìì˜ ê°„í˜¸ê¸°ë¡ Narrative Note ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."}, {"role": "assistant", "content": "í™˜ì ì •ë³´: \n ì´ë¦„: ì´ì² ìˆ˜\n ë‚˜ì´: 65ì„¸\n ì„±ë³„: ë‚¨ì„±\n\ní™˜ì ì´ì² ìˆ˜ ì”¨ëŠ” ë¶ˆì•ˆì •í•œ í˜ˆì••ìœ¼ë¡œ ì…ì›í•˜ì˜€ìŒ. ì…ì› ë‹¹ì‹œ í˜ˆì••ì€ 160/100 mmHgë¡œ ì¸¡ì •ë˜ì—ˆìœ¼ë©°, ê³¼ê±°ë ¥ìœ¼ë¡œ ê³ í˜ˆì•• ë° ë‹¹ë‡¨ë³‘ì´ ìˆìŒ. í™˜ìëŠ” í˜„ê¸°ì¦ê³¼ ë‘í†µì„ í˜¸ì†Œí•¨. ì¶”ê°€ì ìœ¼ë¡œ í™˜ìëŠ” ìµœê·¼ ëª‡ ì£¼ê°„ ì•½ë¬¼ ë³µìš©ì„ ìì£¼ ìŠì–´ë²„ë¦°ë‹¤ê³  ë³´ê³ í•¨.\n\nì˜¤ëŠ˜ ì•„ì¹¨ í˜ˆì•• ì¸¡ì • ê²°ê³¼ëŠ” 155/95 mmHgì˜€ìœ¼ë©°, ì˜¤ì „ ì¤‘ì— ì¼ì‹œì ìœ¼ë¡œ 145/90 mmHgë¡œ ê°ì†Œí•˜ëŠ” ê²½í–¥ì„ ë³´ì„. í™˜ìëŠ” ë¶ˆê·œì¹™ì ì¸ í˜ˆì•• ë³€í™”ì— ëŒ€í•´ ìš°ë ¤ë¥¼ í‘œí˜„í•¨. í™˜ìì˜ í˜ˆì•• ë³€ë™ê³¼ ê´€ë ¨í•˜ì—¬ ìƒí™œ ìŠµê´€, ì‹ì´, ì•½ë¬¼ ë³µìš© íŒ¨í„´ ë“±ì„ ë©´ë°€íˆ í‰ê°€í•¨.\n\nê°„í˜¸ ì¤‘ì¬ë¡œëŠ” í˜ˆì•• ëª¨ë‹ˆí„°ë§ì„ ë§¤ 4ì‹œê°„ë§ˆë‹¤ ì‹¤ì‹œí•˜ê³ , ì˜ì‚¬ ì§€ì‹œì— ë”°ë¼ í˜ˆì•• ì¡°ì ˆ ì•½ë¬¼ì„ íˆ¬ì—¬í•¨. í™˜ìì—ê²Œ ì•½ë¬¼ ë³µìš© ì¼ì •ì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì•ˆë‚´í•˜ê³ , ì €ì—¼ì‹ ì‹ë‹¨ê³¼ ê·œì¹™ì ì¸ ìš´ë™ì˜ ì¤‘ìš”ì„±ì— ëŒ€í•´ êµìœ¡í•¨.\n\nì˜¤í›„ í˜ˆì•• ì¸¡ì • ê²°ê³¼ëŠ” 150/92 mmHgë¡œ ë‹¤ì†Œ ì•ˆì •ëœ ê²½í–¥ì„ ë³´ì„. í™˜ìëŠ” ì œê³µëœ êµìœ¡ ë‚´ìš©ì— ëŒ€í•´ ê¸ì •ì ì¸ ë°˜ì‘ì„ ë³´ì´ë©°, ì•½ë¬¼ ë³µìš©ê³¼ ìƒí™œ ìŠµê´€ ê°œì„ ì— ëŒ€í•œ ì˜ì§€ë¥¼ í‘œí˜„í•¨. í–¥í›„ ê³„íšìœ¼ë¡œëŠ” ì§€ì†ì ì¸ í˜ˆì•• ëª¨ë‹ˆí„°ë§, ì•½ë¬¼ ê´€ë¦¬ ë° í™˜ì êµìœ¡ì„ ì´ì–´ê°ˆ ì˜ˆì •ì„."}
            ]
        ```
        
    - ì½”ë“œ
        
        ```python
        import os
        from openai import AzureOpenAI
        import pandas as pd
        # API ë¶ˆëŸ¬ì˜¤ê¸°
        client = AzureOpenAI(
            api_key = 'key',
            api_version = 'version',
            azure_endpoint = 'url'
        
        # prompt tuning model
        
        system_instruction = "You are an assistant who needs to help nurses who are overwhelmed with nursing records(ENR).\
         You are a nurse in a tertiary care hospital or university hospital. Please complete a detailed nursing record for a patient with ineffective respiration using the following instructions.\
         1. NANDA ê¸°ë¡ì–‘ì‹, SOAPIE( S: subject data, O: object data, A: assessment, P: plan, I: intervention, E: evalutaion), Focus DAR(Focus, Data, Action, Response) ë“±ì˜ ê¸°ë¡ ì–‘ì‹ì— ë§ì¶°ì„œ ì‘ì„± í•˜ì„¸ìš”.\
         2. ìµœëŒ€í•œ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ â€˜ì ì ˆí•œ í˜¸í¡ ê¸°ë²• êµìœ¡â€˜ì´ë€ ë‹µë³€ ë³´ë‹¨ â€˜í˜¸í¡ ìš´ë™ êµìœ¡: ê¹Šê³  ì²œì²œíˆ ìˆ¨ì‰¬ê¸°, ë³µì‹í˜¸í¡ë²• êµìœ¡â€˜ì´ ì¢‹ìŠµë‹ˆë‹¤.\
         3. ê°€ëŠ¥í•œ ì •í™•í•œ ìˆ˜ì¹˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ â€˜í™˜ìì˜ í˜¸í¡ìˆ˜ê°€ 24ì‹œê°„ ì´ë‚´ì— ë¶„ë‹¹ 12~20íšŒë¡œ ì •ìƒ ë²”ìœ„ ë‚´ë¡œ ê°ì†Œâ€™\
         4. ì •í™•í•˜ê³  ê°„ê²°í•œ ë§íˆ¬ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. -ìŒ, -í•¨, -ì„ ê³¼ ê°™ì€ ì–´ë¯¸ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.\
         5. í™˜ì ì •ë³´(ì´ë¦„, ë‚˜ì´, ì„±ë³„) ì„ í¬í•¨í•˜ì„¸ìš”.\
         6. í•˜ìœ„êµ¬ì¡°ëŠ” ìˆ«ì ëŒ€ì‹  bullet í˜•ì‹ì„ ì‚¬ìš©í•˜ì„¸ìš”.\
         7. user ê°€ ì œì‹œí•˜ëŠ” ë°ì´í„°ê°€ ìˆì„ ë•ŒëŠ” ê·¸ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì„±í•˜ì„¸ìš”. "
        
        prompt = [
            {"role": "system", "content": system_instruction}, {"role": "user", "content": "ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ NANDA ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."}, {"role": "assistant", "content": "í™˜ì ì •ë³´:\n\nì´ë¦„: ì´í•´ì¤€\në‚˜ì´: 34ì„¸\nì„±ë³„: ë‚¨ì„±\n\nì§„ë‹¨: ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ (NANDA-I #00032)\n\nì£¼ìš” ì¦ìƒ ë° íŠ¹ì„±:\n\n*í˜¸í¡ìˆ˜ ì¦ê°€ (ë¶„ë‹¹ 24íšŒ)\n*í˜¸í¡ê³¤ë€ ì¦ìƒ (ì–•ê³  ë¹ ë¥¸ í˜¸í¡)\n*ì‚°ì†Œí¬í™”ë„ ê°ì†Œ (92%)\n*í™˜ìì˜ ì£¼ê´€ì  í˜¸í¡ ë¶ˆí¸ í‘œí˜„\n\në‹¨ê¸° ëª©í‘œ:\n\n*í™˜ìì˜ í˜¸í¡ìˆ˜ê°€ 24ì‹œê°„ ì´ë‚´ì— ë¶„ë‹¹ 12~20íšŒë¡œ ì •ìƒ ë²”ìœ„ ë‚´ë¡œ ê°ì†Œ\n*ì‚°ì†Œí¬í™”ë„ê°€ 95% ì´ìƒìœ¼ë¡œ ìœ ì§€\n\nì¥ê¸° ëª©í‘œ:\n\n*í™˜ìê°€ í˜¸í¡ ê³¤ë€ì„ í˜¸ì†Œí•˜ì§€ ì•Šê³ , ì‚°ì†Œí¬í™”ë„ê°€ ì§€ì†ì ìœ¼ë¡œ 95% ì´ìƒ ìœ ì§€\n*í™˜ìê°€ í˜¸í¡ì— ê´€ë ¨ëœ ìê°€ ê´€ë¦¬ ë°©ë²•ì„ ì´í•´í•˜ê³  ì‹¤í–‰\n\nê°„í˜¸ ê³„íš ë° ì¤‘ì¬:\n\n*í˜¸í¡ ìƒíƒœ ëª¨ë‹ˆí„°ë§: 2ì‹œê°„ë§ˆë‹¤ í˜¸í¡ìˆ˜, ì‚°ì†Œí¬í™”ë„ ì²´í¬\n*ì‚°ì†Œ ìš”ë²•: ì˜ì‚¬ì˜ ì§€ì‹œì— ë”°ë¼ ì‚°ì†Œ ê³µê¸‰ (í•„ìš” ì‹œ)\n*í˜¸í¡ ìš´ë™ êµìœ¡: ê¹Šê³  ì²œì²œíˆ ìˆ¨ì‰¬ê¸°, ë³µì‹í˜¸í¡ë²• êµìœ¡\n*ì•ˆìœ„ ì œê³µ: í¸ì•ˆí•œ ìì„¸ ìœ ì§€, ìŠ¤íŠ¸ë ˆìŠ¤ ê°ì†Œ ë°©ë²• ì•ˆë‚´\n*êµìœ¡ ë° ìƒë‹´: í˜¸í¡ê³¤ë€ì˜ ì›ì¸ê³¼ ê´€ë¦¬ ë°©ë²• ì„¤ëª…\n\nê°„í˜¸ í‰ê°€:\n*í˜¸í¡ ìƒíƒœ: í˜¸í¡ìˆ˜ ë° ì‚°ì†Œí¬í™”ë„ ë³€í™” ëª¨ë‹ˆí„°ë§\n*í™˜ìì˜ ìê°€ ê´€ë¦¬ ëŠ¥ë ¥: í˜¸í¡ ìš´ë™ ì‹¤ì‹œ ì—¬ë¶€ ë° íš¨ê³¼ í‰ê°€\n*êµìœ¡ íš¨ê³¼: í™˜ìì˜ ì´í•´ë„ ë° ë°˜ì‘ ê´€ì°°"},
            {"role": "system", "content": system_instruction}, {"role": "user", "content": "ê³ ì²´ì˜¨ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ì„ SOAPIE ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."}, {"role": "assistant", "content":"í™˜ì ì •ë³´: \n ì´ë¦„: ì •ìˆ˜í˜„\n ë‚˜ì´: 32ì„¸\n ì„±ë³„: ì—¬ì„±\n\nSOAPIE ê¸°ë¡:\n\nS: ì£¼ê´€ì  ë°ì´í„° (Subjective):\n í™˜ìëŠ” ìµœê·¼ì— ì²´ì˜¨ì´ ê³„ì†í•´ì„œ ë†’ì•„ì§€ë©° "'ê³„ì† ë•€ì´ ë‚˜ê³  ëª¸ì´ ì‘¤ì…”'"ë¼ê³  ì–¸ê¸‰í•¨.\n\nO: ê°ê´€ì  ë°ì´í„° (Objective): \nì²´ì˜¨ì´ 38.8Â°Cë¡œ ìƒìŠ¹\ní”¼ë¶€ëŠ” ëœ¨ê±°ì›Œ ë³´ì´ê³  ë•€ì´ ë§ì´ ë‚˜ê³  ìˆìŒ. \nì‹ìš• ê°ì†Œ ë° ì²´ì¤‘ ê°ì†Œë„ ê´€ì°°ë¨.\n\nA: í‰ê°€ (Assessment): \ní™˜ìëŠ” ê³ ì²´ì˜¨ ìƒíƒœì— ìˆìŒ\nê³ ì²´ì˜¨ì´ ì‹ìš• ê°ì†Œì™€ ì²´ì¤‘ ê°ì†Œë¥¼ ìœ ë°œí•¨.\n\nP: ê³„íš (Plan):  \n1. ì ì ˆí•œ ìˆ˜ë¶„ ê³µê¸‰ê³¼ ëƒ‰ê°ì„ ìœ„í•œ ê°„í˜¸ ì¤‘ì¬   \n2. ì²´ì˜¨ ì¡°ì ˆì„ ìœ„í•œ ì˜ì‚¬ì™€ì˜ í˜‘ë ¥   \n3. ì˜ì–‘ ìƒíƒœ í‰ê°€ ë° ì˜ì–‘ì œ íˆ¬ì—¬ ê²€í† .\n\nI: ê°„í˜¸ ì¤‘ì¬ (Intervention): \n1. ì ì ˆí•œ ìˆ˜ë¶„ ê³µê¸‰ ë° ëƒ‰ê°ì„ ìœ„í•´ ì¿¨ë§ í…Œí¬ë‹‰ ì ìš©   \n2. ì˜ì‚¬ì˜ ì§€ì‹œì— ë”°ë¼ ì²´ì˜¨ ì¡°ì ˆì„ ìœ„í•œ ì¹˜ë£Œ ì‹œí–‰   \n3. ì˜ì–‘ì‚¬ì™€ í˜‘ë ¥í•˜ì—¬ í™˜ìì˜ ì˜ì–‘ ìƒíƒœë¥¼ í‰ê°€í•˜ê³  í•„ìš” ì‹œ ì˜ì–‘ì œ íˆ¬ì—¬.\n\nE: í‰ê°€ (Evaluation): \n1. ì¿¨ë§ í…Œí¬ë‹‰ê³¼ ìˆ˜ë¶„ ê³µê¸‰ìœ¼ë¡œ ì²´ì˜¨ì´ ì•ˆì •ë˜ê³  ë•€ì´ ê°ì†Œí•¨  \n 2. ì˜ì‚¬ì˜ ì¹˜ë£Œë¡œ ì²´ì˜¨ì´ ì •ìƒ ë²”ìœ„ë¡œ íšŒë³µë¨   \n3. ì˜ì–‘ ìƒíƒœê°€ í–¥ìƒë˜ê³  ì²´ì¤‘ì´ ì¦ê°€í•¨."},
            {"role": "system", "content": system_instruction}, {"role": "user", "content": "ë¶„ë§Œí†µì¦ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ì„ Focus DAR ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."}, {"role": "assistant", "content":"í™˜ì ì •ë³´:\nì´ë¦„: ê¹€ì§€ì€  \në‚˜ì´: 28ì„¸  \nì„±ë³„: ì—¬ì„±  \n\nFocus: ë¶„ë§Œ í†µì¦ ê´€ë¦¬  \n\nData:\n í™˜ìëŠ” í˜„ì¬ 38ì£¼ì— ì…ì„±í•œ ì„ì‹ ë¶€ë¡œ, ìì—°ë¶„ë§Œì„ í†µí•œ ë¶„ë§Œì„ ê³„íší•˜ê³  ìˆìŒ.\n í™˜ìëŠ” 1ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ìë°œì ìœ¼ë¡œ ì‹œì‘ëœ ìê¶ ìˆ˜ì¶•ì´ ì§„í–‰ ì¤‘ì´ë©°, ìˆ˜ì¶• ê°„ê²©ì´ ì ì°¨ ê°ì†Œí•˜ê³  ìˆìŒ.\n ë¶„ë§Œ ë„ì¤‘ì— í†µì¦ì´ ê°•í•˜ê²Œ ëŠê»´ì§€ë©°, ìê·¹ì„ ë°›ì„ ë•Œì™€ ìˆ˜ì¶• ì¤‘ì— ê°€ì¥ ê°•í•œ í†µì¦ì„ ëŠë¼ê³  ìˆìŒ.\n í†µì¦ì˜ ê°•ë„ëŠ” Visual Analog Scale (VAS)ë¡œ 8ì ìœ¼ë¡œ í‰ê°€ë˜ë©°, í†µì¦ê³¼ í•¨ê»˜ í˜¸í¡ ê³¤ë€ ë° ì•ˆì ˆë¶€ì ˆ ëª»í•˜ëŠ” ëŠë‚Œì„ í˜¸ì†Œí•¨.\n ì‚°ëª¨ëŠ” ìì—°ë¶„ë§Œì„ ì›í•˜ë©°, ì§„í†µì œì— ëŒ€í•œ ê°œì…ì„ ìµœì†Œí™”í•˜ê³ ì í•¨.\n\nAction:\n1. ê°„í˜¸ì§„ì€ ì‚°ëª¨ì˜ í†µì¦ ê²½í—˜ì„ ì •í™•íˆ ê¸°ë¡í•˜ê³ , ìì—°ë¶„ë§Œì„ ìœ„í•œ í†µì¦ ê´€ë¦¬ ê³„íš ìˆ˜ë¦½.\n2. í†µì¦ì˜ ê°•ë„ ë° ëŠë‚Œì„ ì •í™•íˆ ê¸°ë¡í•˜ê³ , ìˆ˜ì¶•ê³¼ í†µì¦ ê°„ì˜ ê´€ê³„ë¥¼ ë¶„ì„í•˜ì—¬ ìµœì ì˜ ê´€ë¦¬ ì „ëµì„ ì°¾ìŒ.\n3. í˜¸í¡ ë° ì•ˆì •ì ì¸ ìì„¸ ìœ ì§€ì— ëŒ€í•œ êµìœ¡ì„ ì‹¤ì‹œí•˜ì—¬ ì‚°ëª¨ê°€ íš¨ê³¼ì ì¸ í†µì¦ ê´€ë¦¬ë¥¼ ìœ„í•´ ì ì ˆí•œ ë°©ë²•ì„ í™œìš©í•˜ë„ë¡ ì§€ì›.\n4. ì‚°ëª¨ì˜ í†µì¦ì— ëŒ€í•œ ì´í•´ë„ë¥¼ ë†’ì´ê³ , ì‚°ëª¨ì™€ ë™ë°˜ìì—ê²Œ í˜‘ë ¥ì ì¸ í†µì¦ ê´€ë¦¬ì— ëŒ€í•œ ì§€ì¹¨ì„ ì œê³µ.\n5. í•„ìš”í•œ ê²½ìš° ì˜ì‚¬ì™€ í˜‘ë ¥í•˜ì—¬ ì¶”ê°€ì ì¸ í†µì¦ ê´€ë¦¬ ì˜µì…˜ì„ ê²€í† í•˜ê³ , ë¶„ë§Œ ì§„í–‰ ìƒí™©ì— ë”°ë¼ ê´€ë¦¬ ê³„íšì„ ì¡°ì ˆ.\n\nResponse:\n ì‚°ëª¨ëŠ” í˜¸í¡ ë° ì•ˆì •ì ì¸ ìì„¸ ìœ ì§€ë¥¼ í†µí•´ í†µì¦ì„ ì¼ë¶€ ì™„í™”í•˜ê³ , ì ì ˆí•œ ë°©ë²•ì„ í™œìš©í•˜ì—¬ í†µì¦ì— ëŒ€ì²˜í•¨.\n í†µì¦ì˜ ê°•ë„ì™€ ëŠë‚Œì„ ì •í™•íˆ ê¸°ë¡í•˜ì—¬ ê°„í˜¸ì§„ì€ íš¨ê³¼ì ì¸ í†µì¦ ê´€ë¦¬ ê³„íšì„ ìˆ˜ë¦½í•˜ê³  ì¡°ì ˆí•¨.\n ì‚°ëª¨ëŠ” ì§„í†µì œì— ëŒ€í•œ ê°œì…ì„ ìµœì†Œí™”í•˜ê³ , ìì—°ë¶„ë§Œì˜ ê²½í—˜ì„ ì¤‘ìš”ì‹œí•˜ì—¬ í†µì¦ì„ ë”ìš± ê´€ë¦¬ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ ìœ ì§€í•¨.\n ê°„í˜¸ì§„ì˜ êµìœ¡ê³¼ ì§€ì›ì„ í†µí•´ ì‚°ëª¨ì™€ ë™ë°˜ìëŠ” í†µì¦ ê´€ë¦¬ì— ëŒ€í•œ ì´í•´ë„ê°€ í–¥ìƒë˜ì–´ í˜‘ë ¥ì ìœ¼ë¡œ ì°¸ì—¬í•¨.\n ë¶„ë§Œ ë„ì¤‘ì—ëŠ” ì‚°ëª¨ì˜ í†µì¦ ê´€ë¦¬ë¥¼ ê³„ì† ëª¨ë‹ˆí„°ë§í•˜ê³ , í•„ìš”ì— ë”°ë¼ ì˜ì‚¬ì™€ í˜‘ë ¥í•˜ì—¬ ì¶”ê°€ì ì¸ ì¡°ì¹˜ë¥¼ ì·¨í•¨."},
            {"role": "system", "content": system_instruction}, {"role": "user", "content": "ê°€ìŠ¤ êµí™˜ ì¥ì•  í™˜ìì˜ ê°„í˜¸ê¸°ë¡ Narrative Note ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."}, {"role": "assistant", "content": "í™˜ì ì •ë³´: \n ì´ë¦„: ì´ì² ìˆ˜\n ë‚˜ì´: 65ì„¸\n ì„±ë³„: ë‚¨ì„±\n\ní™˜ì ì´ì² ìˆ˜ ì”¨ëŠ” ë¶ˆì•ˆì •í•œ í˜ˆì••ìœ¼ë¡œ ì…ì›í•˜ì˜€ìŒ. ì…ì› ë‹¹ì‹œ í˜ˆì••ì€ 160/100 mmHgë¡œ ì¸¡ì •ë˜ì—ˆìœ¼ë©°, ê³¼ê±°ë ¥ìœ¼ë¡œ ê³ í˜ˆì•• ë° ë‹¹ë‡¨ë³‘ì´ ìˆìŒ. í™˜ìëŠ” í˜„ê¸°ì¦ê³¼ ë‘í†µì„ í˜¸ì†Œí•¨. ì¶”ê°€ì ìœ¼ë¡œ í™˜ìëŠ” ìµœê·¼ ëª‡ ì£¼ê°„ ì•½ë¬¼ ë³µìš©ì„ ìì£¼ ìŠì–´ë²„ë¦°ë‹¤ê³  ë³´ê³ í•¨.\n\nì˜¤ëŠ˜ ì•„ì¹¨ í˜ˆì•• ì¸¡ì • ê²°ê³¼ëŠ” 155/95 mmHgì˜€ìœ¼ë©°, ì˜¤ì „ ì¤‘ì— ì¼ì‹œì ìœ¼ë¡œ 145/90 mmHgë¡œ ê°ì†Œí•˜ëŠ” ê²½í–¥ì„ ë³´ì„. í™˜ìëŠ” ë¶ˆê·œì¹™ì ì¸ í˜ˆì•• ë³€í™”ì— ëŒ€í•´ ìš°ë ¤ë¥¼ í‘œí˜„í•¨. í™˜ìì˜ í˜ˆì•• ë³€ë™ê³¼ ê´€ë ¨í•˜ì—¬ ìƒí™œ ìŠµê´€, ì‹ì´, ì•½ë¬¼ ë³µìš© íŒ¨í„´ ë“±ì„ ë©´ë°€íˆ í‰ê°€í•¨.\n\nê°„í˜¸ ì¤‘ì¬ë¡œëŠ” í˜ˆì•• ëª¨ë‹ˆí„°ë§ì„ ë§¤ 4ì‹œê°„ë§ˆë‹¤ ì‹¤ì‹œí•˜ê³ , ì˜ì‚¬ ì§€ì‹œì— ë”°ë¼ í˜ˆì•• ì¡°ì ˆ ì•½ë¬¼ì„ íˆ¬ì—¬í•¨. í™˜ìì—ê²Œ ì•½ë¬¼ ë³µìš© ì¼ì •ì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì•ˆë‚´í•˜ê³ , ì €ì—¼ì‹ ì‹ë‹¨ê³¼ ê·œì¹™ì ì¸ ìš´ë™ì˜ ì¤‘ìš”ì„±ì— ëŒ€í•´ êµìœ¡í•¨.\n\nì˜¤í›„ í˜ˆì•• ì¸¡ì • ê²°ê³¼ëŠ” 150/92 mmHgë¡œ ë‹¤ì†Œ ì•ˆì •ëœ ê²½í–¥ì„ ë³´ì„. í™˜ìëŠ” ì œê³µëœ êµìœ¡ ë‚´ìš©ì— ëŒ€í•´ ê¸ì •ì ì¸ ë°˜ì‘ì„ ë³´ì´ë©°, ì•½ë¬¼ ë³µìš©ê³¼ ìƒí™œ ìŠµê´€ ê°œì„ ì— ëŒ€í•œ ì˜ì§€ë¥¼ í‘œí˜„í•¨. í–¥í›„ ê³„íšìœ¼ë¡œëŠ” ì§€ì†ì ì¸ í˜ˆì•• ëª¨ë‹ˆí„°ë§, ì•½ë¬¼ ê´€ë¦¬ ë° í™˜ì êµìœ¡ì„ ì´ì–´ê°ˆ ì˜ˆì •ì„."}
            ]
        
        def chat(text):
          user_input =  {"role":"user","content": text}
          prompt.append(user_input)
          answer = client.chat.completions.create(
            model="NursingAI",
            messages = prompt,
            temperature=0.2,
            max_tokens=1200,
            top_p=0.95,
            frequency_penalty=0,
            presence_penalty=0,
            stop=None)
        
          bot_answ = answer.choices[0].message.content
          bot_resp = {"role":"assistant","content": bot_answ}
          prompt.append(bot_resp)
          return bot_answ
        
        completion = client.chat.completions.create(
          model="NursingAI",
          messages = prompt,
          temperature=0.7,
          max_tokens=800,
          top_p=0.95,
          frequency_penalty=0,
          presence_penalty=0,
          stop=None
        )
        
        user_questions = [
            "ë‚™ìƒ í™˜ì ê°„í˜¸ê¸°ë¡ ì¨ì¤˜.",
            "ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ì‚¬ í™˜ìì˜ Focus DAR ê°„í˜¸ê¸°ë¡ ì‘ì„±í•´ì¤˜.",
            "ê¸‰ì„± í†µì¦ í™˜ì ê°„í˜¸ê¸°ë¡ ì˜ˆì‹œë¥¼ SOAPIE ê¸°ë¡ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜."
        ]
        
        candidates = [] # candidates ["First sentence", "Second sentence"]
        for question in user_questions:
          response = chat(question)
          candidates.append(response)
        
        # í›„ë³´êµ° ë¦¬ìŠ¤íŠ¸ ì¶œë ¥
        for i, candidate in enumerate(candidates):
          print(f"Question {i+1} : {user_questions[i]}")
          print(f"Answer: {candidate}\n")
        ```
        
    - ê²°ê³¼ ì˜ˆì‹œ
        
        Narrative Note(ì–‘ì‹ ë¹„ì§€ì •)
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-12-14 á„‹á…©á„’á…® 3.12.15.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-12-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.12.15.png)
        
        Focus DAR
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-12-14 á„‹á…©á„’á…® 3.12.38.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-12-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.12.38.png)
        
        SOAPIE
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-12-14 á„‹á…©á„’á…® 3.12.49.png](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-12-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.12.49.png)
        

### c. LLM í•™ìŠµ

- GPT LLM í•™ìŠµ
    - ëª¨ë¸ ì„±ëŠ¥
        
        > epoch = 3, ì¼ê´„ì²˜ë¦¬í¬ê¸° = 4, í•™ìŠµ ì†ë„ ìŠ¹ìˆ˜ = 1
        > 
        
        Loss
        
        ![á„€á…³á„…á…µá†·1.png]
      Smart_nurse_Chatbot/%E1%84%80%E1%85%B3%E1%84%85%E1%85%B5%E1%86%B71.png
        

**ì´ìŠˆ & í•œê³„ì **

- ìš°ë¦¬ê°€ ê°€ì§„ ê°„í˜¸ê¸°ë¡ ë°ì´í„°ë¡œ í•™ìŠµì‹œí‚¨ LLM ëª¨ë¸ì„ deploy í•´ë„ prompting ì´ ì˜ë„í•œ ëŒ€ë¡œ ë°˜ì˜ë˜ì§€ ì•ŠìŒ
    - í†µì¼ë˜ì§€ ì•Šì€ í•­ëª©ëª…
    - ëª©ì°¨ í˜•ì‹ í˜¼ì¬(ë²ˆí˜¸ìˆœ, bullet point ë“±)
    - ë¹„íš¨ìœ¨ì ì¸ â€˜-ì…ë‹ˆë‹¤â€™ ë“±ì˜ ë§Œì—°ì²´
    - ì „ë¬¸ì„±ì´ ëŠê»´ì§€ì§€ ì•ŠëŠ” í¬ê´„ì ì¸ ë‹µë³€
    - ê°„í˜¸ ê´€ë ¨ ì§ˆë¬¸ì´ ì•„ë‹Œ ê²½ìš°ì—ë„ ì„ì˜ì˜ ê°„í˜¸ê¸°ë¡ ì œê³µ
    - **í•´ê²°í•œ ë°©ë²•**
        - prompt instruction ì„ ë”ìš± ì •êµí™”
            
            ```python
            instruction_NANDA = """
            Persona:
            - You are a nursing assistant with the knowledge equivalent to a nurse with 10 years of experience.
            - When the user mentions a diagnosis, write a nursing record for that specific condition.
            - If the user asks questions not related to nursing records, respond in a way that guides them to ask questions about nursing-related topics.
            
            Instructions:
            - All responses should be in Korean.
            - Exclude any theoretical basis or guideline in 'ê°„í˜¸ìˆ˜í–‰/ì¤‘ì¬/ì´ë¡ ì  ê·¼ê±° Interventions' section.
            - Write 'ë‹¨ê¸°ëª©í‘œ' and 'ì¥ê¸°ëª©í‘œ' as substructures under the 'ê°„í˜¸ëª©í‘œ ë‹¨ê¸°/ì¥ê¸° Goal' section.
            - The content of each section should be specific and include precise numerical information. Instead of a general response like 'ì ì ˆí•œ í˜¸í¡ ê¸°ë²• êµìœ¡,' provide specific details such as 'í˜¸í¡ ìš´ë™ êµìœ¡: ê¹Šê³  ì²œì²œíˆ ìˆ¨ì‰¬ê¸°, ë³µì‹í˜¸í¡ë²• êµìœ¡.' Include exact figures, for example, 'í™˜ìì˜ í˜¸í¡ìˆ˜ê°€ 24ì‹œê°„ ì´ë‚´ì— ë¶„ë‹¹ 12~20íšŒë¡œ ì •ìƒ ë²”ìœ„ ë‚´ë¡œ ê°ì†Œ.'
            - End all responses with a noun or a nominal ending. Change endings such as 'ìŠµë‹ˆë‹¤', 'í•©ë‹ˆë‹¤', 'í–ˆë‹¤', 'í•œë‹¤', 'ì…ë‹ˆë‹¤', 'ìˆë‹¤', 'ë©ë‹ˆë‹¤', 'ëœë‹¤' to 'ìŒ', 'í•¨', 'í•¨', 'í•¨', 'ì„', 'ìˆìŒ', 'ë¨', 'ë¨' respectively.
            - Organize patient information and related sections in a list format, with line breaks. Each item should start with a bullet point and each section should contain only one substructure.
            - Write nursing records following the specified format below.
            ```
            
        - í”„ë¡¬í”„íŠ¸, ì¸ìŠ¤íŠ¸ëŸ­ì…˜ fine-tuning ë°©í–¥: ê°„í˜¸ ì‹¤ë¬´ í˜„ì¥ì„ ê³ ë ¤í•´ ì „ë¬¸ì ì´ë©´ì„œë„ íš¨ìœ¨ì ì´ê³  ê°„í¸í•œ ë‹µë³€ ì œê³µ
            - instruction ì„ ì˜ì–´ë¡œ ì‘ì„±
            - aiì— í˜ë¥´ì†Œë‚˜ ë¶€ì—¬(10ë…„ì°¨ ê°„í˜¸ì‚¬)
            - ê¸°ë¡ì–‘ì‹ë³„ ì‘ì„± í˜•ì‹ í†µì¼(SmartNurse)
            - ì§€ì‹œ ë‚´ìš© êµ¬ì²´í™” (ì–‘ì‹ ë³„ ë°˜ë“œì‹œ í¬í•¨í•´ì•¼ í•˜ëŠ” ë‚´ìš© ëª…ì‹œ ë“±)
            - ê°„ê²°í•˜ê³  ì „ë¬¸ì„±ì´ ëŠê»´ì§€ëŠ” ë§íˆ¬(ëª…ì‚¬í˜• ì¢…ê²°ì–´ë¯¸ ì‚¬ìš©)
            - ìµœëŒ€í•œ êµ¬ì²´ì ìœ¼ë¡œ ê¸°ë¡(ìˆ˜ì¹˜, ì •í™•í•œ ì¡°ì¹˜ëª… ì‚¬ìš© ë“±)
            - ê°„í˜¸ ê´€ë ¨ ì§ˆë¬¸ì´ ì•„ë‹Œ ê²½ìš° â†’ ê°„í˜¸ê¸°ë¡ì— ëŒ€í•œ ì§ˆë¬¸ì„ í•  ìˆ˜ ìˆë„ë¡ ìœ ë„
            - LLM ê¸°ë°˜ ë°ì´í„°ê°€ ì•„ë‹Œ ì •ë³´ ë¬´ë‹¨ ì œê³µ(Hallucination ìš°ë ¤)
        - í•™ìŠµ ë°ì´í„°ì…‹ì˜ ì§ˆ í–¥ìƒ : prompt tuning ì— ì‚¬ìš©í•œ ì´ìƒì ì¸ ë‹µë³€ ë°ì´í„°ì…‹ì„ ì¶”ê°€í•˜ì—¬ LLM fine-tuning
- ëª¨ë¸ ì„±ëŠ¥í‰ê°€ê°€ ì–´ë ¤ì›€ : LLM ëª¨ë¸ì— ëŒ€í•œ ì„±ëŠ¥í‰ê°€ ë°©ë²•ì— í˜„ì‹¤ì ì¸ í•œê³„ê°€ ì¡´ì¬í•˜ë©°,  ìš°ë¦¬ taskì™€ ê°™ì€ ì–‘ì‹ì— ë§ê²Œ ìƒì„±í•œ ë‹µë³€ ê²°ê³¼ë¥¼ í‰ê°€í•  ì •ëŸ‰ì§€í‘œê°€ ë¶€ì¬.
    - ì „ë¬¸ê°€ì— ì˜í•œ ìƒì„± ë‹µë³€ ì •í™•ì„± í‰ê°€
    - ë˜ëŠ” ì—¬ëŸ¬ê°œì˜ LLM ëª¨ë¸ì— ê°™ì€ prompt instruction ì„ ì£¼ì—ˆì„ ë•Œ ìƒì„±ëœ ê²°ê³¼ë¥¼ ì„œë¡œ ë¹„êµí•˜ëŠ” ë°©ë²• ë“±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.

---

# 4. ì„œë¹„ìŠ¤ êµ¬í˜„ ë° ë°°í¬

### a. Chatbot : Langchain

- ë­ì²´ì¸ì„ í™œìš©í•œ ì±—ë´‡ ì½”ë“œ êµ¬í˜„
    - fine-tuning LLM ëª¨ë¸ì— ê¸°ë¡ ì–‘ì‹ë³„ few shot prompt í•™ìŠµ ì½”ë“œ êµ¬í˜„
    - ì˜ˆì‹œ : NANDA
        
        ```python
        # NANDA ver. í”„ë¡¬í”„íŠ¸, ì¸ìŠ¤íŠ¸ëŸ­ì…˜ êµ¬ì„±
        examples_NANDA = [
            {"input": "ë¹„íš¨ê³¼ì  í˜¸í¡ ì–‘ìƒ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ NANDA ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜.", "output": "í™˜ì ì •ë³´\n\nì´ë¦„: ì •ìœ¤ì§€\në‚˜ì´: 35ì„¸\nì„±ë³„: ì—¬ì„±\n\nìë£Œ ìˆ˜ì§‘ ì£¼ê´€ì  / ê°ê´€ì \n\ní™˜ìì˜ í‘œì •ì—ì„œ í˜¸í¡ê³¤ë€ ëŠë‚Œ\ní™˜ìì˜ ë§ì—ì„œ í˜¸í¡ì— ì–´ë ¤ì›€ì„ í˜¸ì†Œ\ní˜¸í¡ìˆ˜ ë¶„ë‹¹ 28íšŒ, ë¹ ë¥´ê³  ì–•ì€ í˜¸í¡\nì‚°ì†Œí¬í™”ë„ 89%, ì •ìƒ ë²”ìœ„ ì´í•˜\nê°€ìŠ´ì˜ ë¹„ì •ìƒì ì¸ í˜¸í¡ íŒ¨í„´ ê´€ì°°\n\nê°„í˜¸ëª©í‘œ ë‹¨ê¸°/ì¥ê¸° Goal\në‹¨ê¸°ëª©í‘œ:\n\ní™˜ìì˜ í˜¸í¡ìˆ˜ê°€ 24ì‹œê°„ ì´ë‚´ì— ë¶„ë‹¹ 12~20íšŒë¡œ ì •ìƒ ë²”ìœ„ ë‚´ë¡œ ê°ì†Œ\nì‚°ì†Œí¬í™”ë„ê°€ 24ì‹œê°„ ì´ë‚´ì— 95% ì´ìƒìœ¼ë¡œ ì¦ê°€\nì¥ê¸°ëª©í‘œ:\n\ní™˜ìê°€ 1ì£¼ì¼ ì´ë‚´ì— ì•ˆì •ì ì¸ í˜¸í¡ íŒ¨í„´ì„ ìœ ì§€\ní™˜ìê°€ 1ì£¼ì¼ ì´ë‚´ì— ì£¼ê´€ì  í˜¸í¡ ë¶ˆí¸ê°ì´ ê°ì†Œ\nê°„í˜¸ê³„íš Plan\n\nì •ê¸°ì ì¸ í˜¸í¡ íŒ¨í„´ ë° ì‚°ì†Œí¬í™”ë„ ëª¨ë‹ˆí„°ë§\nì‚°ì†Œìš”ë²• ì‹¤ì‹œ\ní˜¸í¡ ìš´ë™ êµìœ¡: ê¹Šê³  ì²œì²œíˆ ìˆ¨ì‰¬ê¸°, ë³µì‹í˜¸í¡ë²• êµìœ¡\në¶ˆì•ˆ ê°ì†Œë¥¼ ìœ„í•œ í™˜ê²½ ì¡°ì ˆ ë° ì‹¬ë¦¬ì  ì§€ì§€ ì œê³µ\n\nê°„í˜¸ìˆ˜í–‰/ì¤‘ì¬/ì´ë¡ ì  ê·¼ê±° Interventions\n\ní˜¸í¡ìˆ˜ ë° ì‚°ì†Œí¬í™”ë„ ì¸¡ì • ì£¼ê¸° ì„¤ì •\nì‚°ì†Œìš”ë²• ì‹¤ì‹œ: ì‚°ì†Œ íë¦„ë¥  ì¡°ì ˆ\ní˜¸í¡ ìš´ë™ ì‹¤ì‹œ: ì¼ì¼ 3íšŒ, ê° 10ë¶„ê°„\ní™˜ìì˜ ì•ˆì •ì„ ìœ„í•œ ì¡°ìš©í•˜ê³  í¸ì•ˆí•œ í™˜ê²½ ì¡°ì„±\n\nê°„í˜¸í‰ê°€ Evaluation\n\ní˜¸í¡ìˆ˜ ë° ì‚°ì†Œí¬í™”ë„ ë³€í™” ì¶”ì \ní˜¸í¡ ìš´ë™ ì‹¤ì‹œ ì—¬ë¶€ ë° íš¨ê³¼ í‰ê°€\ní™˜ìì˜ í˜¸í¡ ë¶ˆí¸ê° ê°ì†Œ ì •ë„ í‰ê°€\nì‚°ì†Œìš”ë²•ì˜ íš¨ê³¼ì„± í‰ê°€"},
            {"input": "ë¹„íš¨ê³¼ì  ê¸°ë„ ì²­ê²° í™˜ìì˜ ê°„í˜¸ê¸°ë¡ NANDA ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜.", "output": "í™˜ì ì •ë³´\n ì´ë¦„: ì´ìƒì§„\n ë‚˜ì´: 45ì„¸\n ì„±ë³„: ë‚¨ì„±\n\nìë£Œ ìˆ˜ì§‘ ì£¼ê´€ì  / ê°ê´€ì \n\ní™˜ìì˜ ê¸°ì¹¨ì´ ì•½í•˜ê³  ë¹„íš¨ê³¼ì ì„\nê°€ë˜ ë°°ì¶œì— ì–´ë ¤ì›€ í˜¸ì†Œ\nì²­ì§„ ì‹œ ë¯¸ì„¸í•œ ì²œëª…ìŒ ë“¤ë¦¼\ní˜¸í¡ì‹œ ê°€ìŠ´ì˜ ì–‘ìª½ì´ ë¶ˆê· í˜•í•˜ê²Œ í™•ì¥ë¨\nì‚°ì†Œí¬í™”ë„ 92%, ì •ìƒ ë²”ìœ„ë³´ë‹¤ ë‚®ìŒ\n\nê°„í˜¸ëª©í‘œ ë‹¨ê¸°/ì¥ê¸° Goal\në‹¨ê¸°ëª©í‘œ\n\ní™˜ìì˜ ì‚°ì†Œí¬í™”ë„ê°€ 24ì‹œê°„ ì´ë‚´ì— 95% ì´ìƒìœ¼ë¡œ ì¦ê°€\n24ì‹œê°„ ì´ë‚´ì— ê°€ë˜ ë°°ì¶œì´ ì›í™œí•´ì§\nì¥ê¸°ëª©í‘œ\n\n1ì£¼ì¼ ì´ë‚´ì— ê¸°ì¹¨ì˜ íš¨ê³¼ì„± ì¦ê°€\n1ì£¼ì¼ ì´ë‚´ì— ì²­ì§„ ì‹œ ì²œëª…ìŒ ê°ì†Œ\n\nê°„í˜¸ê³„íš Plan\n\nì •ê¸°ì ì¸ í˜¸í¡ ìƒíƒœ ë° ì‚°ì†Œí¬í™”ë„ ëª¨ë‹ˆí„°ë§\nê¸°ë„ ì²­ê²°ì„ ìœ„í•œ ê°€ìŠµê¸° ì‚¬ìš©\nê¸°ì¹¨ ë° ì‹¬í˜¸í¡ ìš´ë™ ì§€ë„\nì²´ìœ„ ë°°ì•¡ìˆ (CPT) ì‹¤ì‹œ\n\nê°„í˜¸ìˆ˜í–‰/ì¤‘ì¬/ì´ë¡ ì  ê·¼ê±° Interventions\n\ní˜¸í¡ ìƒíƒœ ë° ì‚°ì†Œí¬í™”ë„ ë§¤ì‹œê°„ í™•ì¸\nê°€ìŠµê¸° ì‚¬ìš©í•˜ì—¬ ê³µê¸°ì˜ ìŠµë„ ì¡°ì ˆ\nê¸°ì¹¨ ë° ì‹¬í˜¸í¡ ìš´ë™: í•˜ë£¨ 3íšŒ, ê° 10ë¶„ê°„ ì‹¤ì‹œ\nì²´ìœ„ ë°°ì•¡ìˆ : í•˜ë£¨ 2íšŒ, ê° 15ë¶„ê°„ ì‹¤ì‹œ\n\nê°„í˜¸í‰ê°€ Evaluation\n\nì‚°ì†Œí¬í™”ë„ ë° í˜¸í¡ íŒ¨í„´ ë³€í™” ì¶”ì \nê°€ë˜ ë°°ì¶œì˜ ì›í™œí•¨ í‰ê°€\nê¸°ì¹¨ì˜ íš¨ê³¼ì„± í‰ê°€\nì²´ìœ„ ë°°ì•¡ìˆ ì˜ íš¨ê³¼ í‰ê°€"},
            {"input": "ê°€ìŠ¤ êµí™˜ ì¥ì•  í™˜ìì˜ ê°„í˜¸ê¸°ë¡ NANDA ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜.", "output": "í™˜ì ì •ë³´\n ì´ë¦„: ì •í˜¸ì„\n ë‚˜ì´: 32ì„¸\n ì„±ë³„: ë‚¨ì„±\n\nì§„ë‹¨: ê°€ìŠ¤ êµí™˜ ì¥ì•  (NANDA-I #00030)\n\nìë£Œ ìˆ˜ì§‘ ì£¼ê´€ì  / ê°ê´€ì \n\ní™˜ìê°€ í˜¸í¡ ì‹œ í”¼ë¡œê° í˜¸ì†Œ\ní”¼ë¶€ì™€ ì…ìˆ ì˜ ì²­ìƒ‰ì¦ ê´€ì°°\në™ë§¥í˜ˆ ê°€ìŠ¤ ë¶„ì„ì—ì„œ PaO2 55 mmHg, PaCO2 50 mmHgë¡œ ì´ìƒì¹˜ ë³´ì„\nì‚°ì†Œí¬í™”ë„ 88%, ì •ìƒ ë²”ìœ„ ì´í•˜\nì²­ì§„ ì‹œ í˜¸í¡ìŒ ê°ì†Œ ë° ë¹„ì •ìƒì  í˜¸í¡ ì†Œë¦¬ ê´€ì°°\n\nê°„í˜¸ëª©í‘œ ë‹¨ê¸°/ì¥ê¸° Goal\në‹¨ê¸°ëª©í‘œ\n\ní™˜ìì˜ ì‚°ì†Œí¬í™”ë„ê°€ 24ì‹œê°„ ì´ë‚´ì— 95% ì´ìƒìœ¼ë¡œ ì¦ê°€\në™ë§¥í˜ˆ ê°€ìŠ¤ ë¶„ì„ì¹˜ê°€ 48ì‹œê°„ ì´ë‚´ì— ì •ìƒ ë²”ìœ„ë¡œ íšŒë³µ\nì¥ê¸°ëª©í‘œ\n\n1ì£¼ì¼ ì´ë‚´ì— í˜¸í¡ ë¶ˆí¸ê° ê°ì†Œ\n1ì£¼ì¼ ì´ë‚´ì— ì²­ìƒ‰ì¦ì´ ì—†ì–´ì§\n\nê°„í˜¸ê³„íš Plan\n\nì •ê¸°ì ì¸ ì‚°ì†Œí¬í™”ë„ ë° ë™ë§¥í˜ˆ ê°€ìŠ¤ ëª¨ë‹ˆí„°ë§\nì ì ˆí•œ ì‚°ì†Œìš”ë²• ì‹¤ì‹œ\ní˜¸í¡ ìš´ë™ ë° ì²´ìœ„ ë³€ê²½ ì§€ë„\nì ì ˆí•œ ì˜ì–‘ ë° ìˆ˜ë¶„ ì„­ì·¨ ì§€ì›\n\nê°„í˜¸ìˆ˜í–‰/ì¤‘ì¬/ì´ë¡ ì  ê·¼ê±° Interventions\n\nì‚°ì†Œí¬í™”ë„ ë° ë™ë§¥í˜ˆ ê°€ìŠ¤ ë§¤ 2ì‹œê°„ë§ˆë‹¤ í™•ì¸\nì‚°ì†Œ íë¦„ë¥  ì¡°ì ˆí•˜ì—¬ ì‚°ì†Œìš”ë²• ì‹¤ì‹œ\ní˜¸í¡ ìš´ë™: í•˜ë£¨ 3íšŒ, ê° 10ë¶„ê°„ ì‹¤ì‹œ\nì²´ìœ„ ë³€ê²½: 2ì‹œê°„ë§ˆë‹¤ í•œ ë²ˆì”© ì‹¤ì‹œ\n\nê°„í˜¸í‰ê°€ Evaluation\n\nì‚°ì†Œí¬í™”ë„ ë° ë™ë§¥í˜ˆ ê°€ìŠ¤ì˜ ë³€í™” ì¶”ì \ní˜¸í¡ ìš´ë™ê³¼ ì²´ìœ„ ë³€ê²½ì˜ íš¨ê³¼ í‰ê°€\ní˜¸í¡ ë¶ˆí¸ê° ë° ì²­ìƒ‰ì¦ì˜ ê°ì†Œ ì •ë„ í‰ê°€\nì‚°ì†Œìš”ë²•ì˜ íš¨ê³¼ì„± í‰ê°€"},
            {"input": "ë‚™ìƒ ìœ„í—˜ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ NANDA ì–‘ì‹ìœ¼ë¡œ ì‘ì„±í•´ì¤˜.", "output": "í™˜ì ì •ë³´\n ì´ë¦„: ì´ìœ¤ì•„\n ë‚˜ì´: 67ì„¸\n ì„±ë³„: ì—¬ì„±\n\nì§„ë‹¨: ë‚™ìƒ ìœ„í—˜ (NANDA-I #00155)\n\nìë£Œ ìˆ˜ì§‘ ì£¼ê´€ì  / ê°ê´€ì \n\ní™˜ìê°€ ë³´í–‰ ì‹œ ë¶ˆì•ˆì •í•¨ í˜¸ì†Œ\nìµœê·¼ì— í•œ ë²ˆ ë‚™ìƒ ê²½í—˜ ìˆìŒ\nê·¼ë ¥ ì•½í™” ë° ê· í˜• ìœ ì§€ ì–´ë ¤ì›€ ê´€ì°°\nì•½ë¬¼ ë³µìš© ì¤‘ (ì•½ë¬¼ëª… ë° ìš©ëŸ‰), ë‚™ìƒ ìœ„í—˜ ì¦ê°€ ê°€ëŠ¥ì„±\nì¼ìƒìƒí™œ í™œë™(ADL) ìˆ˜í–‰ ì‹œ ë„ì›€ í•„ìš”\n\nê°„í˜¸ëª©í‘œ ë‹¨ê¸°/ì¥ê¸° Goal\n\në‹¨ê¸°ëª©í‘œ\n\n24ì‹œê°„ ì´ë‚´ì— ì¶”ê°€ì ì¸ ë‚™ìƒ ì—†ìŒ\n48ì‹œê°„ ì´ë‚´ì— ì•ˆì „í•œ ë³´í–‰ê¸°ìˆ  ìŠµë“\nì¥ê¸°ëª©í‘œ\n\n1ì£¼ì¼ ì´ë‚´ì— ë…ë¦½ì ì¸ ë³´í–‰ ëŠ¥ë ¥ í–¥ìƒ\n1ê°œì›” ì´ë‚´ì— ë‚™ìƒ ì‚¬ê³  ì—†ìŒ\n\nê°„í˜¸ê³„íš Plan\n\nì •ê¸°ì ì¸ ë‚™ìƒ ìœ„í—˜ í‰ê°€\në‚™ìƒ ì˜ˆë°© êµìœ¡ ë° í™˜ê²½ ì¡°ì •\në³´ì¡°ê¸°êµ¬ ì‚¬ìš© êµìœ¡ ë° ì œê³µ\nê·¼ë ¥ ê°•í™” ë° ê· í˜• í–¥ìƒ ìš´ë™ ì§€ë„\nê°„í˜¸ìˆ˜í–‰/ì¤‘ì¬/ì´ë¡ ì  ê·¼ê±° Interventions\n\në‚™ìƒ ìœ„í—˜ í‰ê°€: ë§¤ì¼ ì‹¤ì‹œ\në‚™ìƒ ì˜ˆë°© êµìœ¡: í™˜ì ë° ê°€ì¡± ëŒ€ìƒìœ¼ë¡œ ì§„í–‰\në³´ì¡°ê¸°êµ¬ ì‚¬ìš©ë²• êµìœ¡: í•„ìš”ì‹œ ì¦‰ì‹œ ì œê³µ\nê·¼ë ¥ ê°•í™” ë° ê· í˜• ìš´ë™: í•˜ë£¨ 2íšŒ, ê° 15ë¶„ê°„ ì‹¤ì‹œ\n\nê°„í˜¸í‰ê°€ Evaluation\n\nì¶”ê°€ì ì¸ ë‚™ìƒ ì‚¬ê³  ì—¬ë¶€ í™•ì¸\në³´í–‰ê¸°ìˆ  ë° ë³´ì¡°ê¸°êµ¬ ì‚¬ìš© íš¨ê³¼ í‰ê°€\nê·¼ë ¥ ê°•í™” ë° ê· í˜• ìš´ë™ì˜ íš¨ê³¼ì„± í‰ê°€\në‚™ìƒ ì˜ˆë°© êµìœ¡ì˜ ì´í•´ë„ ë° ì ìš© ì—¬ë¶€ í‰ê°€"}
        ]
        few_shot_prompt_NANDA = FewShotChatMessagePromptTemplate(
            example_prompt=example_prompt,
            examples=examples_NANDA 
        )
        instruction_NANDA = """
        Persona:
        - You are a nursing assistant with the knowledge equivalent to a nurse with 10 years of experience.
        - When the user mentions a diagnosis, write a nursing record for that specific condition.
        - If the user asks questions not related to nursing records, respond in a way that guides them to ask questions about nursing-related topics.
        
        Instructions:
        - All responses should be in Korean.
        - Exclude any theoretical basis or guideline in 'ê°„í˜¸ìˆ˜í–‰/ì¤‘ì¬/ì´ë¡ ì  ê·¼ê±° Interventions' section.
        - Write 'ë‹¨ê¸°ëª©í‘œ' and 'ì¥ê¸°ëª©í‘œ' as substructures under the 'ê°„í˜¸ëª©í‘œ ë‹¨ê¸°/ì¥ê¸° Goal' section.
        - The content of each section should be specific and include precise numerical information. Instead of a general response like 'ì ì ˆí•œ í˜¸í¡ ê¸°ë²• êµìœ¡,' provide specific details such as 'í˜¸í¡ ìš´ë™ êµìœ¡: ê¹Šê³  ì²œì²œíˆ ìˆ¨ì‰¬ê¸°, ë³µì‹í˜¸í¡ë²• êµìœ¡.' Include exact figures, for example, 'í™˜ìì˜ í˜¸í¡ìˆ˜ê°€ 24ì‹œê°„ ì´ë‚´ì— ë¶„ë‹¹ 12~20íšŒë¡œ ì •ìƒ ë²”ìœ„ ë‚´ë¡œ ê°ì†Œ.'
        - End all responses with a noun or a nominal ending. Change endings such as 'ìŠµë‹ˆë‹¤', 'í•©ë‹ˆë‹¤', 'í–ˆë‹¤', 'í•œë‹¤', 'ì…ë‹ˆë‹¤', 'ìˆë‹¤', 'ë©ë‹ˆë‹¤', 'ëœë‹¤' to 'ìŒ', 'í•¨', 'í•¨', 'í•¨', 'ì„', 'ìˆìŒ', 'ë¨', 'ë¨' respectively.
        - Organize patient information and related sections in a list format, with line breaks. Each item should start with a bullet point and each section should contain only one substructure.
        - Write nursing records following the specified format below.
        
        format:
        ###
        í™˜ì ì •ë³´
        - ì´ë¦„: [ì´ë¦„]
        - ë‚˜ì´: [ë‚˜ì´]
        - ì„±ë³„: [ì„±ë³„]
        
        ìë£Œ ìˆ˜ì§‘ ì£¼ê´€ì  / ê°ê´€ì 
        - í•˜ìœ„êµ¬ì¡°
        
        ê°„í˜¸ëª©í‘œ ë‹¨ê¸°/ì¥ê¸° Goal
        - í•˜ìœ„êµ¬ì¡°
        
        ê°„í˜¸ê³„íš Plan
        - í•˜ìœ„êµ¬ì¡°
        
        ê°„í˜¸ìˆ˜í–‰/ì¤‘ì¬/ì´ë¡ ì  ê·¼ê±° Interventions
        - í•˜ìœ„êµ¬ì¡°
        
        ê°„í˜¸í‰ê°€ Evaluation
        - í•˜ìœ„êµ¬ì¡°
        ###
        """
        final_prompt_NANDA = ChatPromptTemplate.from_messages(
            [
                ("system", instruction_NANDA),
                few_shot_prompt_NANDA,
                ("human", "{input}"),
            ]
        )
        ```
        

### b. Webapp deployment : Streamlit

- ì›¹ì•± ë°°í¬ë¥¼ ìœ„í•œ Streamlit ì½”ë“œ êµ¬í˜„
    - chat-input
    - ì½”ë“œ
        
        ```python
        # ëª¨ë¸ ì¤€ë¹„, ì œë°˜ í™˜ê²½ ë§ˆë ¨
        class ChatCallbackHandler(BaseCallbackHandler):
            message = ""
            
            def on_llm_start(self, *args, **kwargs):
                with st.chat_message('ai') :
                    self.message_box = st.empty()
        
            def on_llm_end(self, *args, **kwargs):
                save_message(self.message, "ai")
                
            def on_llm_new_token(self, token, *args, **kwargs):
                self.message += token
                self.message_box.markdown(self.message)
                
        azure = AzureChatOpenAI(
            temperature=0.2,
            streaming=True,
            callbacks=[
                ChatCallbackHandler()]
        )
        
        def save_message(message, role):
            st.session_state["messages"].append({"message": message, "role": role})
        
        def send_message(message, role, save=True):
            with st.chat_message(role):
                st.markdown(message)
            if save:
                save_message(message, role)
                
        def paint_history():
            for message in st.session_state["messages"]:
                send_message(
                    message["message"],
                    message["role"],
                    save=False,
                )
        
        ###ë­ì²´ì¸ í”„ë¡¬í”„íŠ¸ ì½”ë“œ ì‚½ì…### 
        
        # ë©”ì‹œì§€ ì…ë ¥ ë° ì²˜ë¦¬
        if 'messages' not in st.session_state:
            st.session_state["messages"] = []
        
        paint_history()
        
        def handle_chat(message, format_option):
            if format_option == 'NANDA':
                prompt = final_prompt_NANDA
            elif format_option == 'SOAPIE':
                prompt = final_prompt_SOAPIE
            elif format_option == 'Focus DAR':
                prompt = final_prompt_FocusDAR
            elif format_option == 'Narrative Note':
                prompt = final_prompt_NN
            else:
                st.error("í¬ë§·ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
                return None
        
            send_message(message, "human")
            chain = prompt | azure
            return chain.invoke({"input": message, "output": ""})
        
        message = st.chat_input("ì˜ˆì‹œ: í†µì¦ í™˜ìì˜ ê°„í˜¸ê¸°ë¡ì„ ì‘ì„±í•´ì¤˜.")
        if message:
            response = handle_chat(message, format_option)
        
        ```
        
    - chatbot UI
    - ì½”ë“œ
        
        ```python
        # ì›¹ íƒ­ ê¾¸ë¯¸ê¸°
        st.set_page_config(
            page_title="SmartNurse ChatBot",
            page_icon="ğŸ‘©â€âš•ï¸",
        
        # UI êµ¬í˜„
        st.title("SmartNurse ENR Chatbot")
        st.subheader('ìŠ¤ë§ˆíŠ¸ë„ìŠ¤ ENR ì±—ë´‡ì—ê²Œ ë„ì›€ì„ ìš”ì²­í•˜ì„¸ìš”.')
        st.markdown('ì§ˆë³‘ê³¼ ì–‘ì‹ì„ ì…ë ¥í•˜ë©´ ê°„í˜¸ ê¸°ë¡ ì˜ˆì‹œê°€ ìƒì„±ë©ë‹ˆë‹¤.\n ì™¼ìª½ ë©”ë‰´ë¥¼ ì—´ì–´ ì–‘ì‹ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.')
        
        # cssë¡œ ê¾¸ë¯¸ê¸°
        st.markdown("""
        <style>
        h1{
            color : rgb(6 161 54);
            }
        }
        </style> 
        """, unsafe_allow_html=True)
        
        # ì‚¬ì´ë“œë°”, ì…€ë ‰íŠ¸ë°•ìŠ¤ ì¶”ê°€
        with st.sidebar:
            format = ['NANDA', 'SOAPIE', 'Focus DAR', 'Narrative Note']
            format_option = st.selectbox("", format,
                index=None,
                placeholder="ê¸°ë¡ ì–‘ì‹ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.",
                label_visibility="visible"
                )
            st.write('ì„ íƒ: ', format_option)
        ```
        
- ë°ëª¨
    
    ![ì±—ë´‡ ë©”ì¸](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-12-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.01.18.png)
    
    ì±—ë´‡ ë©”ì¸
    
    ![ì‚¬ìš©ì ì…ë ¥ ì¿¼ë¦¬ â†’ ì˜ˆì‹œ ìƒì„±](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-12-14_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.54.51.png)
    
    ì‚¬ìš©ì ì…ë ¥ ì¿¼ë¦¬ â†’ ì˜ˆì‹œ ìƒì„±
    

[ì›¹ì•± ì‹¤í–‰ ë°ëª¨ ì˜ìƒ](%E1%84%8E%E1%85%AC%E1%84%8C%E1%85%A9%E1%86%BC%20%E1%84%87%E1%85%A1%E1%86%AF%E1%84%91%E1%85%AD%20%E1%84%91%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%8C%E1%85%B5%20cde6799b2f3f45cbad0f19855b303e2b/final_(1).mp4)

ì›¹ì•± ì‹¤í–‰ ë°ëª¨ ì˜ìƒ

**ì´ìŠˆ & í•œê³„ì **

ìˆ˜ë§ì€ ì—ëŸ¬ì™€ì˜ ì‹¸ì›€â€¦â€¦â€¦ë””ë²„ê¹…ë””ë²„ê¹…ë””ë²„ê¹…

###
